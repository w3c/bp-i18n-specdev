<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Internationalization Best Practices for Spec Developers</title>
    <meta charset="utf-8"/>
    <!-- <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet"> -->
    <script src="make_checklist.js"></script>
    <script src="index-data/dumpdata.js"></script>
    <!--
      === NOTA BENE ===
      For the three scripts below, if your spec resides on dev.w3 you can check them
      out in the same tree and use relative links so that they'll work offline,
     -->
    <script async src="https://www.w3.org/Tools/respec/respec-w3c" class="remove"></script>
    <script class="remove">
      var respecConfig = {
          // specification status (e.g. WD, LCWD, NOTE, etc.). If in doubt use ED.
          specStatus:           "ED",
          //publishDate:  		"2015-10-20",
          previousPublishDate:  "2020-05-29",
          previousMaturity:  	"WD",


          noRecTrack:           true,
          shortName:            "international-specs",
          copyrightStart: 		"2014",
          edDraftURI:   		"https://w3c.github.io/bp-i18n-specdev/",

          // editors, add as many as you like
          // only "name" is required
          editors:  [
              { name: "Richard Ishida", url: "",
                company: "W3C", companyURL: "",
    			w3cid: 39125 }
          ],


          group:        "i18n",
          wgPublicList: "www-international",

          github: "w3c/bp-i18n-specdev",
		  maxTocLevel: 2,
      };
    </script>
	<link rel="stylesheet" href="local.css" type="text/css" />
  </head>
  <body>
  <div id="abstract">
      <p>This document provides a checklist of internationalization-related considerations when developing a specification. Most checklist items point to detailed supporting information in other documents. Where such information does not yet exist, it can be given a temporary home in this document. The dynamic page <a href="https://www.w3.org/International/techniques/developing-specs-dynamic">Internationalization Techniques: Developing specifications</a> is automatically generated from this document. <strong>The current version is still an early draft, and it is expected that the information will change regularly as new content is added and existing content is modified in the light of experience and discussion.</strong></p>
  </div>

  <div id="sotd">
  <p>This document provides advice to specification developers about how to incorporate requirements for international use. What is currently available here is expected to be useful immediately, but is still an early draft and the document is in flux, and will grow over time as knowledge applied in reviews and discussions can be crystallized into guidelines.</p>
    <div class="note">
    <p data-lang="en" style="font-weight: bold; font-size: 120%">Sending comments on this document</p>
  	<p data-lang="en">If you wish to make comments regarding this document, please raise them as <a href="https://github.com/w3c/bp-i18n-specdev/issues" style="font-size: 120%;">github issues</a>. Only send comments by email if you are unable to raise issues on github (see links below).</p>
  	<p data-lang="en">To make it easier to track comments, please raise separate issues or emails for each comment, and point to the section you are commenting on using  a URL for the dated version of the document.   All comments are welcome.</p>
    </div>
</div>

  <section id="intro">
    <h2>Introduction</h2>
      <p>Developers of specifications need advice  to ensure that what they produce will work for communities around the globe.</p>
      <p>The Internationalization (i18n) WG tries to assist working groups  by reviewing specifications and engaging in discussion. Often, however, such interventions come later in the process than would be ideal, or mean that the i18n WG has to repeat the same information for each working group it interacts with.</p>
      <p>It would be better if specification developers could access a checklist of best practices, which points  to explanations, examples and rationales where developers need it. Developers would then be able to build this knowledge into their work from the earliest stages, and could thereby reduce  rework needed when the i18n WG reviews their specification.</p>
      <p>This document contains the beginnings of a checklist, and points to locations where you can find explanations, examples and rationales for recommendations&nbsp;made.&nbsp; If there is no such other place, that extra information will be added to this document. It is still early days for this document, and it may also be used to develop ideas and organize them.</p>
      <p>The guidelines in this document are not intended to be hard and fast requirements. This document will achieve a significant part of its purpose if, where you don't understand the guidelines or disagree with them, you contact the Internationalization WG to discuss what should be done.</p>
      <p>You may prefer to use <a href="https://www.w3.org/International/techniques/developing-specs?collapse">Internationalization Techniques: Developing specifications</a> most of the time, since it uses JavaScript to  help you more quickly see what's available and drill down to the information you need. (Where needed, it links to this or other documents.) There is also a <a href="https://www.w3.org/International/techniques/developing-specs">non-dynamic version</a> of the document available.</p>
<p>If your spec is github based, you can now create a snapshot of the checklist items in markdown. If you add that to a github issue, you can check off items that are ok, and add comments while doing a self-review. <a href="https://w3c.github.io/bp-i18n-specdev/#ghChecklist">Generate the code here</a>.</p>




  </section>

  <!-- end of characters section -->




<section id="resource" class="topic">
  <h2>Language</h2>

		<ul class="summary">
					<li><a href="#sec_lang_decl">Language basics</a></li>
					<li><a href="#sec_lang_values">Defining language values</a></li>
					<li><a href="#sec_lang_mixed">Declaring language at the resource level</a></li>
					<li><a href="#lang_block">Establishing the language of a content block</a></li>
					<li><a href="#lang_inline">Establishing the language of inline runs</a></li>
  </ul>



  <section id="sec_lang_decl" class="subtopic">
  <h3>Language basics</h3>

  <p class="advisement" id="lang_basics_1"><a class="self" href="#lang_basics_1">&#x200B;</a>It should be possible to associate a language with any piece of natural language text that will be read by a user. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_decl">more</a></p>
  <p class="advisement" id="lang_basics_inline"><a class="self" href="#lang_basics_inline">&#x200B;</a>Where possible, there should  be a way to label natural language changes in inline text. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_decl">more</a></p>
  <p>Text is rendered or processed differently according to the language it is in. For example, screen readers need to be prompted when a language changes, and spell checkers should be language-sensitive. When rendering text a knowledge of language is need in order to apply correct fonts, hyphenation, line-breaking, upper/lower case changes, and other features.</p>
  <p>For example, ideographic characters such as 雪, 刃, 直, 令, 垔 have slight but important differences when used with  Japanese vs Chinese fonts, and it's important not to apply a Chinese font to the Japanese text, and vice versa when it is presented to a user.</p>
  <p class="advisement" id="lang_basics_meta"><a class="self" href="#lang_basics_meta">&#x200B;</a>Consider whether it is useful to express the <a href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_meta">intended linguistic audience</a> of a resource, in addition to specifying the language used for <a href="https://w3c.github.io/bp-i18n-specdev/#sec_text_processing_lang">text processing</a>. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_decl">more</a></p>
   <p>Language information for a given resource can be used with two main objectives in mind: for text-processing, or as a statement of the intended use of the resource. We will explain the difference below.</p>

  <section id="sec_text_processing_lang">
    <h4>Text-processing language information</h4>
    <p class="advisement" id="tp_lang_values"><a class="self" href="#tp_lang_values">&#x200B;</a>A language declaration that indicates the <a href="https://w3c.github.io/bp-i18n-specdev/#sec_text_processing_lang">text processing language</a> for a range of text must associate  a single language  value with a specific range of text. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_text_processing_lang">more</a></p>
    <p>When specifying the <dfn>text-processing language</dfn> you are declaring the language in which <strong>a specific range of text is actually written</strong>, so that user agents or applications that manipulate the text, such as voice browsers, spell checkers,  style processors, hyphenators, etc., can apply the appropriate rules to the text in question. So we are, by necessity, talking about associating a <em>single</em> language with a <em>specific</em> range of text.</p>
    <p>It is normal to express a text-processing language as the default language, for processing the resource as a whole, but it may also be necessary to indicate where the language changes within the resource.</p>
    <p class="advisement" id="lang_attribute_xml"><a class="self" href="#lang_attribute_xml">&#x200B;</a>Use the HTML <code class="kw" translate="no">lang</code> and XML <code class="kw" translate="no">xml:lang</code> language attributes where appropriate to identify the <a href="https://w3c.github.io/bp-i18n-specdev/#sec_text_processing_lang">text processing language</a>, rather than creating a new attribute or mechanism. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_attribute_xml">more</a></p>
    To identify the text-processing language for a range of text, HTML provides the <code class="kw" translate="no">lang</code> attribute, while XML provides <code class="kw" translate="no">xml:lang</code> which can be used in all XML formats. It's useful to continue using those attributes for relevant markup formats, since authors recognize them, as do HTML and XML processors.
  </section>

  <section id="sec_lang_meta">
    <h4>Language metadata about the resource as a whole</h4>
    <p>It may also be useful to describe the language of a resource <strong> as a whole</strong>. This type of language declaration typically indicates the <strong>intended use of the resource</strong>. For example, such metadata may be used for searching, serving the right language version, classification, etc. </p>
    <p>This type of language declaration differs from that of the text-processing declaration in that (a)  the value for such declarations may be more than one  language subtag, and (b) the language value declared doesn't indicate which bits of a multilingual resource are in which language.</p>
     <p class="advisement" id="metadata_lang_values"><a class="self" href="#metadata_lang_values">&#x200B;</a>It should be possible to associate a  metadata-type language declaration (which indicates the intended use of the resource rather than the language of a specific range of text)  with multiple language  values. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_meta">more</a></p>
   <p>The language(s) describing the intended use of a resource do not necessarily include every language used in a document. For example, many documents on the Web contain embedded fragments of content in different languages, whereas the page is clearly aimed at speakers of one particular language. For example, a German city-guide for Beijing may contain useful phrases in Chinese, but it is aimed at a German-speaking audience, not a Chinese one.</p>
    <p>On the other hand, it is also possible to imagine a situation where a document contains the same or parallel content in more than one language. For example, a web page may welcome Canadian readers with French content in the left column, and the same content in English in the right-hand column. Here the document is equally targeted at speakers of both languages, so there are two audience languages. Another use case is a blog or a news page aimed at a multilingual community, where some articles on a page are in one language and some in another. In this case, it may make sense to list more than one  language tag as the value of the language declaration.</p>
<p class="advisement" id="metadata_not_lang"><a class="self" href="#metadata_not_lang">&#x200B;</a>Attributes that express the language of external resources should not use the HTML <code class="kw" translate="no">lang</code> and XML <code class="kw" translate="no">xml:lang</code> language attributes, but should use a different attribute when they represent metadata (which indicates the intended use of the resource rather than the language of a specific range of text). <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_meta">more</a></p>
<p>Using a different attribute to indicate the language of an external resource allows the attribute to specify more than one language. It also works better if the resource pointed to is not in a single language. </p>
<p>This distinction can be seen in HTML in the separation of the <code class="kw" translate="no">lang</code> and <code class="kw" translate="no">hreflang</code> attributes. The former indicates the language of the text within the HTML page; the latter is metadata indicating the  expected language of a page that is linked to.</p>
<p>For a longer discussion of this see <a href="https://www.w3.org/International/questions/qa-when-xmllang">xml:lang in XML document schemas</a>. This article talks specifically about <code class="kw" translate="no">xml:lang</code>, but the concepts are applicable to other situations.</p>
  </section>

<section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
<p class="link"><a href="https://www.w3.org/International/questions/qa-when-xmllang">xml:lang in XML document schemas</a></p>
<p class="desc">When should I use <code class="kw" translate="no">xml:lang</code> and when should I define my own element or attribute for passing language values in an XML document schema (DTD)?</p>
</li>
<li class="w3">
  <p class="link"><a href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_decl">Language basics</a></p>
  <p class="desc">In <a href="https://w3c.github.io/bp-i18n-specdev/">Internationalization Best Practices for Spec Developers</a>.</p>
</li>
        </ul>
      </section>

      <section class="background">
        <h5>Background</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/International/questions/qa-lang-why">Why use the language attribute?</a></p>
            <p class="desc">Describes why it is useful to use the <code class="kw" translate="no">lang</code> or <code class="kw" translate="no">xml:lang</code> attribute to label language in web pages.</p>
          </li>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/i18n-discuss/notes/annotation-language-use-cases">Use cases for language information in web annotations</a></p>
            <p class="desc">Description of use cases for annotations that illustrate the differences between text-processing and metadata types of language declaration.</p>
          </li>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/International/questions/qa-http-and-lang">HTTP headers, meta elements and language information</a></p>
            <p class="desc">How the distinction between text-processing language and language metadata plays out in HTML5.</p>
          </li>
        </ul>
      </section>
    </section>
  </section>

  <section id="sec_lang_values" class="subtopic">
    <h3>Defining language values</h3>

      <p class="advisement" id="lang_use_bcp47"><a class="self" href="#lang_use_bcp47">&#x200B;</a>Values for language declarations must use BCP 47. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_values">more</a></p>
    <p>BCP 47 defines a method to combine subtags in order to create a much more powerful notation for language tags than that provided by the old ISO lists, but it is also backwards compatible with the ISO lists.</p>
    <p>For an overview of the key features of BCP 47, see <a href="https://www.w3.org/International/articles/language-tags/">Language tags in HTML and XML</a>.</p>
    <p class="advisement" id="lang_bcp_not_rfc"><a class="self" href="#lang_bcp_not_rfc">&#x200B;</a>Refer to BCP 47, not to RFC 5646. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_values">more</a></p>
    <p>The link to and name of BCP 47 was created specifically so that there is an unchanging reference to the definition of Tags for the Identification of Languages. RFCs 1766, 3066, 4646 were previous (superseded) versions and 5646 is the current version of BCP 47.</p>

    <p class="advisement" id="lang_values_specificity"><a class="self" href="#lang_values_specificity">&#x200B;</a>Be specific about what level of conformance you expect for language tags: BCP 47 defines two levels of conformance, "valid" and "well-formed".</p>

    <p>A <strong>well-formed</strong> BCP 47 language tag follows the syntax defined for a language tag: implementations check that each language tag consists of hyphen-separated subtags; each subtag has a specific length and specific content (letters, digits or specific combinations) depending on the placement in the tag. A <strong>valid</strong> BCP 47 language tag is well-formed but additionally ensures that only subtags that are listed in the IANA Subtag Registry are used. Note that the IANA Subtag Registry is frequently updated with new subtags.</p>

    <p class="advisement" id="lang_checking_well_formed"><a class="self" href="#lang_checking_well_formed">&#x200B;</a>Specifications may require implementations to check if language tags are "valid", but in most circumstances should only require that the language tags be "well-formed".</p>

    <p>Most specifications are second-order consumers of language metadata &ndash; they are using data already provided in the document format (HTML <span class=kw translate=no>lang</span>, XML <span class=kw translate=no>xml:lang</span>, or the document format's language fields/attributes).</p>

    <p>Generally most specifications are concerned with selecting resources (such as spell checkers, tokenizers, fonts, etc.) or with matching (selecting which string to show, for example) and don't directly care about the content of the language tag. Invalid-but-well-formed tags just don't match anything and usually fallback schemes provide some behavior that is appropriate.</p>

    <p>There might be cases where a specification really wants implementation-level checking for validity. In those cases, the result of a tag failing to be valid has to be specified (should the application die, warn the user, etc.). It's also a problem that the registry is sizeable and changes over time, so each implementation is registry-version dependent. The changes over time are often minor, but real users will encounter interoperability issues if random (out of date) implementations of the specification reject language tags that have become valid at a later date.</p>

    <p>In addition, BCP 47 has an extension mechanism which defines add-on subtag sequences. For example, one extension [[RFC6067]] (Unicode Locales, which uses the singleton <span class=kw translate=no>-u</span>), is commonly used for controlling the internationalization features of JavaScript (and has other uses). Validating these additional subtags is likely out of scope for most specifications.</p>

    <p class="advisement" id="lang_values_valid"><a class="self" href="#lang_values_valid">&#x200B;</a>Specifications should require content and content authors to use "valid" language tags.</p>

    <p>Normative language regarding language tags might be different between content and implementation requirements. Specification authors need to carefully consider what conformance requirements and tests are needed for their specification and what implementations are required to do. One solution is to normatively require that "valid" language tags be used by content authors but only require implementations to check for "well-formed" language tags.</p>

    <p class="advisement" id="lang_matching_bcp"><a class="self" href="#lang_matching_bcp">&#x200B;</a>Reference BCP47 for language tag matching.</p>

 <p>BCP 47 contains one RFC dedicated to the syntax and subtags of language tags, and another dedicated to how to match two or more subtags.  (This topic needs more detail, and may merit being a separate section.)</p>
     <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_values">Defining language values</a></p>
            <p class="desc">In <a href="https://w3c.github.io/bp-i18n-specdev/">Internationalization Best Practices for Spec Developers</a>.</p>
          </li>
          <li class="nonw3">
            <p class="link"><a href="https://www.rfc-editor.org/rfc/bcp/bcp47.txt">BCP 47</a></p>
            <p class="desc">The IETF specification that indicates how to create language subtags and how to match them<a href="https://w3c.github.io/bp-i18n-specdev/"></a>.</p>
          </li>
        </ul>
      </section>

    <section class="background">
        <h5>Background</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/International/articles/language-tags/">Language tags in HTML and XML</a></p>
            <p class="desc">An overview of how to create language tags using BCP 47.</p>
          </li>
        </ul>
      </section>
    </section>
  </section>


<section id="sec_lang_mixed" class="subtopic">
    <h3>Declaring  language at the resource level</h3>
   <p>Here we are talking about an independent unit of data that contains structured text. Examples may include a whole HTML page, an XML document, a JSON file, a WebVTT script, an annotation, etc.</p>
   <p class="advisement" id="lang_whole_res"><a class="self" href="#lang_whole_res">&#x200B;</a>The specification should indicate how to define the default text-processing language for the resource as a whole. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_whole_res">more</a></p>
    <p>It often saves trouble to identify the language, or at least the default language, of the resource as a whole in one place. For example, in an HTML file, this is done by setting the <code class="kw" translate="no">lang</code> attribute on the <code class="kw" translate="no">html</code> element.</p>
    <p class="advisement" id="lang_inherit"><a class="self" href="#lang_inherit">&#x200B;</a>Content within the resource should inherit the language of the text-processing declared at the resource level, unless it is specifically overridden.</p>
    <p class="advisement" id="lang_tp_meta"><a class="self" href="#lang_tp_meta">&#x200B;</a>Consider whether it is necessary to have separate declarations to indicate the text-processing language versus metadata about the expected use of the resource. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_tp_meta">more</a></p>
    <p>In many cases a resource contains  text in only one language, and in many more cases the language declared as the default language for text-processing is the same as the language that describes the metadata about the resource as a whole. In such cases it makes sense to have a single declaration.</p>
    <p>It becomes problematic, however, to use a single declaration when it refers to more than one language unless there is a way to determine which one language should be used as the text-processing default.</p>
    <p class="advisement" id="lang_mixing"><a class="self" href="#lang_mixing">&#x200B;</a>If there is only one language declaration for a resource, and it has more than one language tag as a value, it must be possible to identify the default text-processing language for the resource. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_tp_meta">more</a></p>
  <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/bp-i18n-specdev/#sec_lang_mixed">Declaring language at the resource level</a></p>
            <p class="desc">In <a href="https://w3c.github.io/bp-i18n-specdev/">Internationalization Best Practices for Spec Developers</a>.</p>
          </li>
        </ul>
      </section>

      <section class="background">
        <h5>Background</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/i18n-discuss/notes/annotation-language-use-cases">Use cases for language information in web annotations</a></p>
            <p class="desc">Description of use cases for annotations that illustrate the differences between text-processing and metadata types of language declaration.</p>
          </li>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/International/questions/qa-http-and-lang">HTTP headers, meta elements and language information</a></p>
            <p class="desc">How the distinction between text-processing language and language metadata plays out in HTML5.</p>
          </li>
        </ul>
      </section>
    </section>

    <section class="xref"><h4>See also</h4>
        <p><a href="#sec_lang_values">Defining language values</a>.</p>
    </section>

 </section>


    <section id="lang_block" class="subtopic">
  <h3>Establishing the language of a content block</h3>
    <p>The words <dfn>block</dfn> and/or <dfn>chunk</dfn> are used here to refer to a structural component within the resource as a whole that groups content together and separates it from adjacent content. Boundaries between one block and another are equivalent to paragraph or section boundaries in text, or discrete data items inside a file. </p>
    <p>For example, this could refer to a block or paragraph in XML or HTML, an object declaration in JSON, a cue in WebVTT, a line in a CSV file, etc. Contrast this with <dfn>inline</dfn> content, which describes a range within a paragraph, sentence, etc.</p>
    <p>The interpretation of which structures defined in a spec are relevant to these requirements may require a little consideration, and will depend on the format of the data involved.</p>
  <p class="advisement" id="lang_block_inherit"><a class="self" href="#lang_block_inherit">&#x200B;</a>By default, blocks of content should inherit any text-processing language set for the resource as a whole.   <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_block_inherit">more</a></p>
  <p>See <a href="#sec_lang_decl"></a> for guidance related to the default text-processing language information.</p>
  <p class="advisement" id="lang_block_change"><a class="self" href="#lang_block_change">&#x200B;</a>It should be possible to indicate a change in language for blocks of content where the language changes. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_block_change">more</a></p>

     <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/bp-i18n-specdev/#lang_block">Establishing the language of a content block</a></p>
            <p class="desc">In <a href="https://w3c.github.io/bp-i18n-specdev/">Internationalization Best Practices for Spec Developers</a>.</p>
          </li>
        </ul>
      </section>
    </section>

    <section class="xref"><h4>See also</h4>
        <p><a href="#sec_lang_values">Defining language values</a>.</p>
    </section>
</section>


<section id="lang_inline" class="subtopic">
  <h3>Establishing the language of inline runs</h3>
  <p>Here we refer to information that needs to be provided for a range of characters in the middle of a paragraph or string.</p>
  <p class="advisement" id="lang_inline_spans"><a class="self" href="#lang_inline_spans">&#x200B;</a>It should be possible to indicate language for spans of inline text where the language changes. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#lang_inline_spans">more</a></p>
  <p>Where a switch in language can affect operations on the content, such as spell-checking, rendering, styling, voice production, translation, information retrieval, and so forth, it is necessary to indicate the range of text affected and identify the language of that content.</p>

     <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/bp-i18n-specdev/#lang_inline">Establishing the language</a></p>
            <p class="desc">In <a href="https://w3c.github.io/bp-i18n-specdev/">Internationalization Best Practices for Spec Developers</a>.</p>
          </li>
        </ul>
      </section>
    </section>

    <section class="xref"><h4>See also</h4>
        <p><a href="#sec_lang_values">Defining language values</a>.</p>
    </section>
</section>

</section>



<section id="text_direction" class="topic">
<h2>Text direction</h2>
				<ul class="summary">
				  <li><a href="#sec_dir_basic"></a></li>
				  <li><a href="#sec_dir_background"></a></li>
				  <li><a href="#sec_bidi_markup"></a></li>
				  <li><a href="#sec_bidi_strings"></a></li>
				</ul>



  <p>It is important to establish direction for text written or mixed with right-to-left scripts. Characters in these scripts are stored in memory in the order they are typed and pronounced – called the logical order. The Unicode Bidirectional Algorithm (UBA) provides a lot of support for automatically rendering a sequence of characters stored in  logical order so that they are visually ordered as expected. Unfortunately, the UBA alone is not sufficient to correctly render bidirectional text, and additional information has to be provided about the default directional context to apply for a given sequence of characters.</p>

 <section id="sec_dir_basic" class="subtopic">
  <h3>Basic requirements</h3>
 <p>The basic requirements are as follows.</p>
    <p class="advisement" id="dir_paragraphs"><a class="self" href="#dir_paragraphs">&#x200B;</a>It must be possible to indicate base direction for each individual paragraph-level item of natural language text that will be read by someone. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#dir_paragraphs">more</a></p>
    <p class="advisement" id="dir_inline"><a class="self" href="#dir_inline">&#x200B;</a>It must be possible to indicate base direction changes for embedded runs of inline bidirectional text for all natural language text that will be read by someone. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#dir_inline">more</a></p>
    <p class="advisement" id="dir_reasonable"><a class="self" href="#dir_inline">&#x200B;</a>Annotating right-to-left text must require the minimum amount of effort for people who work natively with right-to-left scripts. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#dir_reasonable">more</a></p>
    <p>Requiring a speaker of Arabic, Divehi, Hebrew, Persian, Urdu, etc. to add markup or control characters to every paragraph or small data item they write is far too much to be manageable. Typically, the format should establish a default direction and require the user to intervene only when exceptions have to be dealt with.</p>
</section>


<section id="sec_dir_background" class="subtopic">
  <h3>Background information</h3>
	<p>In this section we try to set out some key concepts associated with text direction, so that it will be easier to understand the recommendations that follow.</p>


<section id="sec_dir_defs">
  <h4>Important definitions</h4>
  <p>In order to correctly display text written in a 'right-to-left' script or left-to-right text containing bidirectional elements, it is important to establish the <a href="https://www.w3.org/International/articles/inline-bidi-markup/uba-basics#context" class="termref">base direction</a> that will be used to dictate the order in which elements of the text will be displayed.</p>
  <p>If you are not familiar with what the Unicode Bidirectional Algorithm (UBA) does and doesn't do, and why the base direction is so important, read <a href="https://www.w3.org/International/articles/inline-bidi-markup/uba-basics">Unicode Bidirectional Algorithm basics</a>.</p>
  <aside class="example">
    <p>For example, the following annotation will not display correctly unless the application doing the display knows that the base direction needs to be right-to-left.</p>
    <pre>{
  "@context": "http://www.w3.org/ns/anno.jsonld",
  "id": "http://example.org/anno5",
  "type":"Annotation",
  "body": {
    "type" : "TextualBody",
    "text" : "פעילות הבינאום, W3C",
    "format" : "text/html",
    "language" : "he"
  },
  "target": "http://example.org/photo1"
}
    </pre>
    <p>You would expect the phrase in the <code class="kw" translate="no">text</code> property value to be displayed as</p>
    <p><span dir="rtl">פעילות הבינאום, W3C</span></p>
    <p>however, if there is no indication that the base direction should be right-to-left the following incorrect display will be produced:</p>
    <p>פעילות הבינאום, W3C</p>
  </aside>

  <p>In this section, the word <dfn>paragraph</dfn> indicates a run of text followed by a hard line-break in plain text, but may signify different things in other situations. In CSV it equates to 'cell', so a single line of comma-separated items is actually a set of comma-separated paragraphs.&nbsp; In HTML it equates to the lowest level of block element, which is often a <code class="kw" translate="no">p</code> element, but may be things such as <code class="kw" translate="no">div</code>, <code class="kw" translate="no">li</code>, etc., if they only contain text and/or inline elements. In JSON, it often equates to a quoted string value, but if a string value uses markup then paragraphs are associated with block elements, and if the string value is multiple lines of plain text then each line is a paragraph.</p>
  <p>The term <dfn>metadata</dfn> is used here to mean information which could be an annotation or property associated with the data, or could be markup in scenarios that allow that, or could be a higher-level protocol, etc.</p>
</section>


<section id="setting_bd">
<h4>Ways base direction can be set for paragraphs</h4>
<p>There are a number of possible ways of setting the base direction.</p>
<ol>
  <li>The base direction of a paragraph may be set by an application or a user applying metadata to the paragraph.  Typical values for base direction may include <code class="kw" translate="no">ltr</code>, <code class="kw" translate="no">rtl</code> or <code class="kw" translate="no">auto</code>.
<ul>
  <li>The metadata may specifically indicate that  heuristics should be used. Then you would expect to consider the actual characters used in order to determine the base direction. (This is what happens if you set <code>dir=auto</code> on an HTML element.)</li>
  <li>The application may expect metadata, but there may be no such information provided.  In this case you would usually expect there to be a default direction specified, and the base direction for a cell would be set to that default.  The default is usually LTR. (This is what happens if you have no <code class="kw" translate="no">dir</code> attributes in your HTML file.)</li>
  <li>Where a format contains many paragraphs or chunks of information, and the language of text in all those chunks is the same, it is sometimes useful to allow a default base direction to be set for and inherited by all. This is what happens when you set the <code class="kw" translate="no">dir</code> attribute on the <code class="kw" translate="no">html</code> tag in HTML. Another example would be a subtitling file containing many cues, all written in Arabic; it would be best to allow the author to say at the start of the file that the default is RTL for all cue text. There should always be a way to override the direction information for a specific paragraph where needed.</li>
  </ul></li>
  <li>If the application expects no metadata to be available it should use heuristics to determine the base direction for each paragraph/cell. A typical solution, and one described by UAX	9 <cite>Unicode Bidirectional Algorithm</cite>, is to look for the first-strong character in the paragraph/cell.  (This is likely to apply if you are looking at plain text  that is not expected to be associated with metadata. It only happens with HTML if the direction is set to <code class="kw" translate="no">auto</code>, since HTML specifies a default direction.)
    <ul style="margin-left:0; margin-right:1em;">
  <li>Not all paragraphs using the first-strong method will have the correct base direction applied. In some cases, an Arabic or Hebrew, etc, paragraph may start with strong LTR characters. There must be a way to deal with this.</li>
  <li>Where a syntactic unit contains multiple lines of plain text (for example, a multiline cue text in a subtitling file), the first-strong heuristic needs to be applied to each line separately.</li>
  <li>There may be special rules that involve ignoring some sequence of characters or type of markup at the start of the paragraph before identifying the first strong character.</li>
  <li>In some cases there are no strong characters in a paragraph, and the base direction can be critically important for the data to be understood correctly, eg. telephone numbers or MAC addresses. There needs to be a way to resort to an appropriate default for these cases.</li>
  </ul></li>
  <li>Whether or not  any metadata is specified, if a paragraph contains a string that starts with one of the Unicode bidi control characters  RLI, LRI, FSI, LRE, RLE, LRO, or RLO and ends with PDF/PDI, these characters will determine the base direction for the contained string. These characters, when placed in the content, explicitly override any previously set direction by creating an inline range and assigning a base direction to it.
    <ul style="margin-left:0; margin-right:1em;"><li>The effect of such characters does not extend past paragraph boundaries, but the range ought to be explicitly ended using the PDF/PDI control character, especially if a paragraph end is not easily detectable by the application.)</li>
      <li>Because isolation is needed for bidirectional text to work properly, the Unicode Standard says that the isolating control codes RLI, LRI and FSI should be used rather than LRE or RLE. Unfortunately, those characters are still not widely supported.</li>
      <li>For structural components in markup, above the paragraph level, it is not possible to use the Unicode bidi control characters to define direction for  paragraphs, since these are inline controls only, and the effect is terminated by a paragraph end.</li>
      </ul>
  </li>
  </ol>
<p>When capturing text input by a user it is usually necessary to understand the context in which the user was inputting the data to determine the base direction of the input. In HTML, for example, this may be set by the direction inherited from the <code class="kw" translate="no">html</code> tag, or by the user pressing keys to set the base direction for a form field. It is then necessary to find some way of storing the information about base direction or associating it with the string when rendered. Typically, in this situation, any direction changes internal to the string being input are handled by the user and will be captured as part of the string.</p>
</section>




<section id="inline_changes">
<h4>Inline changes to base direction</h4>
<p>Embedded ranges of text <em>within</em> a single paragraph may need to have a different base direction. For example, </p>
<p>&quot;The title was '!NOITASILANOITANRETNI'.&quot;</p>
<p>where the span within the single quotes is in Hebrew/Arabic/Divehi, etc., and needs to have a RTL base direction, instead of the LTR base direction of the surrounding paragraph, in order to place the exclamation mark correctly. </p>
<p>If markup is available to the content author, it is likely to be easier and safer to use markup to indicate such inline ranges (see below). In HTML you would usually use an inline element with a <code class="kw" translate="no">dir</code> attribute to establish the base direction for such runs of text.  If you can't mark up the text, such as in HTML's <code class="kw" translate="no">title</code> element, or any environment that handles only plain text content, you have to resort to Unicode's paired control characters to establish the base direction for such an internal range.</p>
<p>Furthermore, inline ranges where the base direction is changed should be isolated from surrounding text, so that the UBA doesn't produce incorrect results due to interference across boundaries. <a href="http://www.w3.org/International/articles/inline-bidi-markup/#uc5">See an&nbsp;example</a> of how this can produce incorrect ordering of things such&nbsp;as text followed by numbers in HTML, or <a href="http://www.w3.org/International/articles/inline-bidi-markup/#usecase3">another example</a> of how it can affect lists.</p>
<p>This means that if a content author is using Unicode control codes they should use RLI/LRI...PDI rather than RLE/LRE...PDF.&nbsp; These isolating codes are fairly new, and applications may not yet support them.</p>
</section>




<section id="control_problems">
<h4>Problems with control characters</h4>
<p>Reasons to avoid relying on  control characters to set direction  include the following:</p>
<ol>
  <li>They are invisible in most editors and are therefore difficult to work with, and can easily lead to orphans and overlapping ranges.  They can be particularly difficult to manage when editing bidirectional inline text because it's hard to position the cursor in the correct place. If you ask someone who writes in a right-to-left script, you are likely to find that they dislike using control codes.</li>
  <li>Users often don't have the necessary characters available on their keyboard, or have difficulty inputting them.</li>
  <li>It is sometimes necessary to choose which to use based on context or the type of the data, and this means that a content author typically needs to select the control codes – specifying control codes in this way for all paragraphs is time-consuming and error-prone.</li>
  <li>Processors that extract parts of the data, add to it, or reuse in combination with other text  may incorrectly handle the control codes.</li>
  <li>Search and comparison algorithms should ignore these characters, but typically don't.</li>
  </ol>
<p>The last two items above may also hold for markup, but implementers often support included markup better than  included control codes.</p>
<p>Don't expect users to add control codes at the start and end of every paragraph. That's far too much work.</p>
</section>


<section id="rlmlrm">
<h4>RLM and LRM</h4>
<p>A word about the Unicode characters <span class="uname">U+200F   RIGHT-TO-LEFT MARK</span> (RLM) and <span class="uname">U+200E   LEFT-TO-RIGHT MARK</span> (LRM) is warranted at this point.</p>
<p>The first point to be clear about is that neither RLM nor LRM establish the base direction for a range of text.&nbsp; They are simply invisible characters with strong directional properties.</p>
<p>This means that you cannot use RLM for example, to make the text W3C appear to the left of the Hebrew text in the following example.</p>
<p>The title is "<span dir="rtl">פעילות הבינאום, W3C</span>".</p>
<p>For this you can only use metadata or the paired control characters.</p>
<p>Of course, if you are detecting base direction using first-strong heuristics then RLM and LRM can be useful for setting the base direction where the text in question begins with something that would otherwise give the wrong result, eg. </p>
<p>"<span dir="rtl">نشاط التدويل</span>" is how you say "i18n Activity" in Arabic.</p>
<p>Here an LRM could be placed at the start of the text, before the strong RTL Arabic characters, to prevent the algorithm from assuming that the text should be right-to-left. (Remember that if metadata is used to set the base direction, that character is ignored, unless the metadata specifically says that first-strong heuristics should be used.)</p>
</section>


<section id="bd_language">
<h4>Base direction and language</h4>
    <p class="advisement" id="bidi_lang"><a class="self" href="#bidi_lang">&#x200B;</a>Do not assume that direction can be determined from language information. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#bidi_lang">more</a></p>
    <p>The following are all reasons you cannot use language tags to provide information about base direction:</p>
    <ol>
    <li>you can't produce the <code class="kw" translate="no">auto</code> value with language tags.</li>
    <li>some languages are written with both RTL and LTR scripts.</li>
    <li>the only reliable part of the language tag that would indicate the base direction is the script tag, but BCP47 recommends that you suppress the use of the script tag for languages that don't usually need it, such as  Hebrew (<code>suppressscript: Hebr</code>). Languages, such as Persian, that are usually written in a RTL script may be written in transcribed form, and it's not possible to guarantee that the necessary script tag would be present to carry the directional information. In summary, you won't be able to rely on people supplying script tags as part of the language information in order to influence direction.</li>
    <li>the incidence of use of language tags and base direction markers  often don't coincide.</li>
    <li>they are not semantically equivalent.</li>
    </ol>
</section>
</section>



<section id="sec_bidi_values" class="subtopic">
<h3>Base direction values</h3>
<p class="advisement" id="bidi_values"><a class="self" href="#bidi_values">&#x200B;</a>Values for the default base direction should include left-to-right, right-to-left, and auto. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#bidi_values">more</a></p>
<p>The <code class="kw" translate="no">auto</code> value allows automatic detection of the base direction for a piece of text. For example, the <code class="kw" translate="no">auto</code> value of <code class="kw" translate="no">dir</code> in HTML looks for the first strong directional character in the text, but ignores certain items of markup also, to guess the base direction of the text. Note that automatic detection algorithms are far from perfect. First-strong detection is unable to correctly identify text that is really right-to-left, but that begins with a strong LTR character. Algorithms that attempt to judge the base direction based on contents of the text are also problematic. The best scenario is one where the base direction is known and declared.</p>
</section>




<section id="sec_bidi_markup" class="subtopic">
	<h3>Handling direction in markup</h3>

  <section id="sec_default_base">
    <h4>Setting the default base direction</h4>
    <p class="advisement" id="bidi_whole_res"><a class="self" href="#bidi_whole_res">&#x200B;</a>The spec should  indicate how to define a default base direction for the resource as a whole, ie. set the overall base direction. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#bidi_whole_res">more</a></p>
    <p class="advisement" id="bidi_res_default"><a class="self" href="#bidi_res_default">&#x200B;</a>The  default base direction, in the absence of other information, should be LTR. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#bidi_res_default">more</a></p>
</section>



  <section id="bidi_block">
    <h4>Establishing the base direction for paragraphs</h4>
  <p class="advisement" id="bidi_block_change"><a class="self" href="#bidi_block_change">&#x200B;</a>The content author must be able to indicate parts of the text where the base direction changes. At the block level, this should be achieved using attributes or metadata, and should not rely on Unicode control characters. </p>
  <p>Relying on Unicode control characters to establish direction for every block is not feasible because line breaks terminate the effect of such control characters. It also makes the data much less stable, and unnecessarily difficult to manage if control characters have to appear at every point where they would be needed.</p>
  <p class="advisement" id="bidi_block_auto"><a class="self" href="#bidi_block_auto">&#x200B;</a>It must be possible to also set the direction for content fragments to <code class="kw" translate="no">auto</code>. This means that the base direction will be determined by examining the content itself.</p>
  <p>A typical approach here would be to set the direction based on the first strong directional character outside of any markup, but this is not the only possible method. The algorithm used to determine directionality when direction is set to auto should match that expected by the receiver.</p>
  <p>The first-strong algorithm looks for the first character in the paragraph with a strong directional property according to the Unicode definitions. It then sets the base direction of the paragraph according to the direction of that character.</p>
  <p>Note that the first-strong algorithm may incorrectly&nbsp;guess the direction of the paragraph when the first character is not typical of the rest of the paragraph, such as when a RTL paragraph or line starts with a LTR brand name or technical term.</p>
  <p>For additional information about algorithms for detecting direction, see <a href="https://www.w3.org/TR/html-bidi/#auto-direction-algorithms">Estimation algorithms</a> in the document where this was discussed with reference to HTML.</p>
  <p class="advisement" id="bidi_block_para"><a class="self" href="#bidi_block_para">&#x200B;</a>If the overall base direction is set to <code class="kw" translate="no">auto</code> for plain text, the direction of content paragraphs should be determined on a paragraph by paragraph basis. </p>
  <p class="advisement" id="bidi_block_befaft"><a class="self" href="#bidi_block_befaft">&#x200B;</a>To indicate the sides of a block of text where relative to the start and end of its contained lines, you should use 'before' and 'after' (maybe block-start/block-end – the terminology is changing), rather than 'top' and 'bottom'. </p>
  <p class="advisement" id="bidi_inline_start_end"><a class="self" href="#bidi_inline_start_end">&#x200B;</a>To indicate the start/end of a line  you should use 'start' and 'end' rather than 'left' and 'right'. </p>
  <p class="advisement" id="bidi_dedicated_attr"><a class="self" href="#bidi_dedicated_attr">&#x200B;</a>Provide dedicated attributes for control of base direction and bidirectional overrides; do not rely on the user applying style properties to arbitrary markup to achieve bidi control.</p>
  <p>For example, HTML has a <code class="kw" translate="no">dir</code> attribute that is capable of managing base direction without assistance from CSS styling. XML formats should define dedicated markup to represent directional information, even if they need CSS to achieve the required display, since the text may be used in other ways.</p>
  <p>Style sheets such as CSS may not always be used with the data, or carried with the data when it is syndicated, etc. Directional information is fundamentally important to correct display of the data, and should be associated more closely and more permanently with the markup or data.</p>
</section>

  <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/html-bidi/#auto-direction-algorithms">Estimation algorithms</a></p>
            <p class="desc">In <a href="https://www.w3.org/TR/html-bidi/">Additional Requirements for Bidi in HTML &amp; CSS</a>.</p>
          </li>
        </ul>
      </section>
</section>
</section>





<section id="sec_bidi_strings" class="subtopic">
	<h3>Handling base direction for strings</h3>
<p class="note">The information in this section is pulled from <a href="https://w3c.github.io/string-meta/">Requirements for Language and Direction Metadata in Data Formats</a>. That document is still being written, so these guidelines are likely to change at any time.</p>

  <p class="advisement" id="bidi_strings_metadata"><a class="self" href="#bidi_strings_metadata">&#x200B;</a>Provide metadata constructs that can be used to indicate the base direction of any natural language string. <a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">more</a></p>

  <p class="advisement" id="bidi_strings_heuristics"><a class="self" href="#bidi_strings_heuristics">&#x200B;</a>Specify that consumers of strings should use  heuristics, preferably based on the Unicode Standard first-strong algorithm, to detect the base direction of a string except where metadata is provided. <a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">more</a></p>

  <p class="advisement" id="bidi_strings_default"><a class="self" href="#bidi_strings_default">&#x200B;</a>Where possible, define a field to  indicate the default direction for all strings in a given resource or document. <a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">more</a></p>

  <p class="advisement" id="bidi_strings_metadata_and_default"><a class="self" href="#bidi_strings_metadata_and_default">&#x200B;</a>Do NOT assume that a creating a document-level default without the ability to change direction for any string is sufficient. <a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">more</a></p>

  <p class="advisement" id="bidi_strings_script_tag"><a class="self" href="#bidi_strings_script_tag">&#x200B;</a>If metadata is not available due to legacy implementations and cannot otherwise be provided, specifications MAY allow a base direction to be interpolated from available language metadata. <a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">more</a></p>

  <p class="advisement" id="bidi_strings_paired_controls"><a class="self" href="#bidi_strings_paired_controls">&#x200B;</a>Specifications MUST NOT require the production or use of paired bidi controls. <a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">more</a></p>

  <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
<ul>
<li class="w3">
<p class="link"><a href="https://w3c.github.io/string-meta/">Requirements for Language and Direction Metadata in Data Formats</a></p>
<ul>
<li class="sub">
<p class="link"><a href="https://w3c.github.io/string-meta/#best-practices-recommendations-and-gaps">Best Practices, Recommendations, and Gaps</a></p>
</li>
<li class="sub">
<p class="link"><a href="https://w3c.github.io/string-meta/#requirements-and-use-cases">Requirements and Use Cases</a></p>
</li>
<li class="sub">
<p class="link"><a href="https://w3c.github.io/string-meta/#approaches-considered-for-identifying-the-base-direction">Approaches Considered for Identifying the Base Direction</a></p>
</ul>
</li>
</ul>
</section>
</section>
</section>







  <section id="bidi_inline" class="subtopic">
    <h3>Setting base direction for inline or substring text</h3>
<p>'Inline text' here has a readily understandable meaning in markup. It also applies to strings (eg. in JSON, CVS, or other plain text formats), meaning runs of characters which don't include all the characters in the string.</p>
    <p class="advisement" id="bidi_inline_change"><a class="self" href="#bidi_inline_change">&#x200B;</a>It must be possible to indicate spans of inline text where the base direction changes. If markup is available, this is the preferred method. Otherwise your specification must require that Unicode control characters are recognized by the receiving application, and correctly implemented.</p>
    <p class="advisement" id="bidi_inline_auto"><a class="self" href="#bidi_inline_auto">&#x200B;</a>It must be possible to also set the direction for a span to auto. This means that the base direction will be determined by examining the content itself. A typical approach here would be to set the direction based on the first strong directional character outside of any markup. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#bidi_inline_auto">more</a></p>
    <p>The first-strong algorithm looks for the first character in the paragraph with a strong directional property according to the Unicode definitions. It then sets the base direction of the paragraph according to the direction of that character.</p>
    <p>Note that the first-strong algorithm may incorrectly&nbsp;guess the direction of the paragraph when the first character is not typical of the rest of the paragraph, such as when a RTL paragraph or line starts with a LTR brand name or technical term.</p>
    <p>For additional information about algorithms for detecting direction, see <a href="https://www.w3.org/TR/html-bidi/#auto-direction-algorithms">Estimation algorithms</a> in the document where this was discussed with reference to HTML.</p>
    <p class="advisement" id="bidi_inline_rli"><a class="self" href="#bidi_inline_rli">&#x200B;</a>If users use Unicode bidirectional control characters, the isolating RLI/LRI/FSI with PDI characters must be supported by the application and recommended (rather than RLE/LRE with PDF) by the spec.</p>
    <p class="advisement" id="bidi_inline_rlm"><a class="self" href="#bidi_inline_rlm">&#x200B;</a>Use of RLM/LRM should be appropriate, and expectations of what those controls can and cannot do should be clear in the spec. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#bidi_inline_rlm">more</a></p>
    <p>The Unicode bidirectional control characters <span class="uname">U+200F RIGHT-TO-LEFT MARK</span> and <span class="uname">U+200E LEFT-TO-RIGHT MARK</span> are not sufficient on their own to manage bidirectional text. They cannot produce a different base direction for embedded text. For that you need to be able to indicate the start and end of the range of the embedded text.&nbsp; This is best done by markup, if available, or failing that using the other Unicode bidirectional controls mentioned just above.</p>
<p class="advisement" id="bidi_inline_dedicated_attr"><a class="self" href="#bidi_inline_dedicated_attr">&#x200B;</a>For markup, provide dedicated attributes for control of base direction and bidirectional overrides; do not rely on the user applying style properties to arbitrary markup to achieve bidi control.</p>
    <p class="advisement" id="bidi_inline_all_elems"><a class="self" href="#bidi_inline_all_elems">&#x200B;</a>For markup, allow bidi attributes on all inline elements in markup that contain text.</p>
    <p class="advisement" id="bidi_inline_embed"><a class="self" href="#bidi_inline_embed">&#x200B;</a>For markup, provide attributes that allow the user to (a) create an embedded base direction or (b) override the bidirectional algorithm altogether; the attribute should allow the user to set the direction to LTR or RTL or the aforementioned Auto in either of these two scenarios.</p>
</section>


</section>






<section id="characters" class="topic">
<h2>Characters</h2>
				<ul class="summary">
					<li><a href="#char_def">Choosing a definition of  'character' </a></li>
					<li><a href="#char_referencemodel">Defining a Reference Processing Model </a></li>
					<li><a href="#char_ranges">Including and excluding character ranges</a></li>
					<li><a href="#char_pua">Using the Private Use Area </a></li>
					<li><a href="#char_choosing">Choosing character encodings </a></li>
					<li><a href="#char_identifying">Identifying character encodings </a></li>
					<li><a href="#char_escapes">Designing character escapes </a></li>
					<li><a href="#char_storing">Storing text </a></li>
<li><a href="#char_string">Defining 'string' </a></li>
<li><a href="#char_unicoderef">Referencing the Unicode Standard </a></li>
				</ul>
<p>See the <a href="https://www.w3.org/TR/charmod/">Character Model for the World Wide Web: Fundamentals</a> for basic guidelines related to the use of characters and encodings.</p>
<p>See the <a href="https://encoding.spec.whatwg.org/">Encoding</a> specification for further guidelines related to use of character encodings.</p>
<p>Another Character Model document is currently in development, entitled <a href="https://w3c.github.io/charmod-norm/">String Matching</a>. It looks at issues that arise when you try to compare two strings, be it identifiers or authored content.</p>

<hr/>

    <p>The term <em>character</em> is often used to mean different things in different contexts: it can variously refer to the visual, logical, or byte-level representation of a given piece of text. This makes the term too imprecise to use when specifying algorithms, protocols, or document formats. Understanding how characters are defined and encoded in computing systems, along with the associated terminology used to make such specification unambiguous, is thus a necessary prerequisite to discussing the processing of string data.</p>

    <p>The visual manifestation of a "character"&mdash;the shape most people mean when they say "character"&mdash;is what we call a <dfn>user-perceived character</dfn>. These visual building blocks are usually perceived to be a single unit of the visible text.</p>

    <p>At their simplest, user-perceived characters are a single shape that can be tied one-to-one to the underlying computing representation. But a user-perceived character can be formed, in some scripts, from more than one character. And a given logical character can take many different shapes due to such influences as font selection, style, or the surrounding context (such as adjacent characters). In some cases, a single user-perceived character might be formed from a long sequence of logical characters. And some logical characters (so-called "combining marks") are always used in conjunction with another character.</p>

    <p>When user-perceived characters are represented visibly (on screen or in print), they are represented by individual rendering units. This visual unit is called a <dfn>grapheme</dfn> (the word <dfn>glyph</dfn> is also used). Graphemes are the visual units found in fonts and rendering software.</p>

    <aside class=example>
		<h5>Examples of user-perceived characters</h5>
		<p>Here is the word for "Unicode" in the Latin, Katakana, Arabic, and Devanagari scripts.</p>
		<p class=bigtext>Unicode
		   <span lang=ja>&#x30E6;&#x30CB;&#x30B3;&#x30FC;&#x30C9;</span>
		   <span lang=ar dir=rtl>&#x064A;&#x0648;&#x0646;&#x064A;&#x0643;&#x0648;</span>
		   <span lang=hi>&#x092F;&#x0942;&#x0928;&#x093F;&#x0915;&#x094B;&#x0921;</span>
		</p>
		<p>The last example, in the Devanagari script (which is used to write Hindi, among other languages) is made up of four graphemes:</p>
		<p class=bigtext lang=hi>&#x092F;&#x0942;&nbsp;&#x0928;&#x093F;&nbsp;&#x0915;&#x094B;&nbsp;&#x0921;</p>
    </aside>

    <p>Graphemes are encoded into computer systems using "logical characters". A <dfn>character set</dfn> is a set of logical characters: a specific collection of characters that can be used together to encode text. The most important character set is the <dfn>Universal Character Set</dfn>, also known as [[Unicode]]. This character set includes all of the characters used to encode text, including historical or extinct writing systems as well as modern usage, private use, typesetting symbols, and other things, such as the emoji. Other character sets are defined subsets of Unicode. In Unicode, a 'character' is a single abstract logical unit of text. Each character in Unicode is assigned a unique integer number between <code>0x0000</code> and <code>0x10FFFF</code>, which is called its <dfn>code point</dfn>. The term code point therefore unambiguously refers to a single logical character and its integer representation.</p>

    <p class=advisement id="char_term_def"><a class="self" href="#char_term_def">&#x200B;</a>Specifications SHOULD explicitly define the term 'character' to mean a Unicode code point.</p>

    <p>The relationship between code points and graphemes can be complex. In most cases, a code point sequence that forms a single grapheme should be treated as a single textual unit. For example, when cursoring across text, an entire grapheme should select together. It shouldn't be possible to cursor into the "middle" of a grapheme or delete only a part of user-perceived character. Because the relationship is not one-to-one between code points and graphemes and because the relationship can be somewhat complex, [[Unicode]] defines a specific type of grapheme: the <dfn>extended grapheme cluster</dfn> which most closely matches the mapping of the underlying logical character sequence to a user-perceived character. When referring to 'graphemes' in this document, we mean extended grapheme clusters (unless otherwise called out).</p>

    <aside class=example>
		<h5>Hindi example showing mapping from graphemes to code points</h5>
		<p>Returning to the example above, the Hindi word for Unicode is made of four graphemes:</p>
		<p class=bigtext lang=hi>&#x092F;&#x0942;&nbsp;<span style="color:red">&#x0928;&#x093F;</span>&nbsp;&#x0915;&#x094B;&nbsp;&#x0921;</p>
		<p>Several of these graphemes are made up of more than one Unicode character because of the way that the Devanagari script works. In Devanagari, the basic set of "letters" are syllables ending with the short 'a' vowel sound. When you want to use a different vowel, you add a combining vowel character that changes the shape of the grapheme. The red text in the example above is the syllable "ni" in "Unicode". It is made of two characters: U+0928 (the syllable "na") and U+093F (combining "short i" sound):</p>

		<table>
			<tr>
				<td class=bigtext>&#x092f;</td>
				<td class=bigtext>&#x0942;</td>
				<td class=bigtext style="color:red">&#x0928;</td>
				<td class=bigtext style="color:red">&#x093f;</td>
				<td class=bigtext>&#x0915;</td>
				<td class=bigtext>&#x094b;</td>
				<td class=bigtext>&#x0921;</td>
			</tr>
			<tr>
				<td><code>U+092F</code></td>
				<td><code>U+0942</code></td>
				<td><code>U+0928</code></td>
				<td><code>U+093F</code></td>
				<td><code>U+0915</code></td>
				<td><code>U+094B</code></td>
				<td><code>U+0921</code></td>
			</tr>
		</table>

    </aside>

    <p>Another example of the complex relationship between code points and graphemes are certain emoji. The emoji character for "family" has a code point in Unicode: <span class="codepoint"><span lang="en">&#x1F46A;</span> [<span class="uname">U+1F46A FAMILY</span>]</span>. It can also be formed by using using a sequence of code points: <span class="uname">U+1F468 U+200D U+1F469 U+200D U+1F466</span>. Altering or adding other emoji characters can alter the composition of the family. For example the sequence <span class="uname" translate="no">&#x1f468;&#x200d;&#x1f469;&#x200d;&#x1f467;&#x200d;&#x1f467; U+1F468 U+200D U+1F469 U+200D U+1F467 U+200D U+1F467</span> results in a composed emoji character for a "family: man, woman, girl, girl" on systems that support this kind of composition. Many common emoji can <em>only</em> be formed using sequences of code points, but should be treated as a single user-perceived character when displaying or processing the text. You wouldn't want to put a line-break in the middle of the family!</p>

    <p>Unicode code points are just abstract integer values: they are not the values actually present in the memory of the computer or serialized on the wire. When processing text, computers use an array of fixed-size integer units. One such common unit is the <dfn>byte</dfn> (or <em>octet</em>, since bytes have 8 bits per unit). There are also 16-bit, 32-bit, or other size units. In many programming languages, the unit is called a <code>char</code>, which suggests that strings are made of "characters". We use the term <dfn>code unit</dfn> to refer unambiguously to the programming and serialized representation of characters. For example, in C, a <code>char</code> is generally an 8-bit byte: each <code>char</code> is a 8-bit code unit. In Java or Javascript, a <code>char</code> is a 16-bit value.</p>

    <p>A set of rules for converting code points to or from code units is called a <dfn>character encoding form</dfn> (or just "character encoding" for short.</p>

    <aside class=example>
       <h2>UTF-8 Character Encoding Form</h2>

       <p>The most common character encoding used on the Web is UTF-8. UTF-8 uses 8-bit bytes as its code unit. Each Unicode code point encoded into UTF-8 takes between one and four bytes to encode. ASCII characters take one byte to encode. Code points from 0x80 to 0x7FF take two bytes. Code points from 0x800 to 0xFFFF take three bytes. And code points from 0x10000 to 0x10FFFF (that is, the rest of Unicode) take four bytes each.</p>

       <table class=cpExample>
		   <tr>
			   <td>Grapheme</td>
			   <td class=bigtext>A</td>
			   <td class=bigtext>&#xc0;</td>
		   </tr>
		   <tr>
			   <td>Code Point</td>
			   <td><code>U+0041</code></td>
			   <td><code>U+00C0</code></td>
		   </tr>
		   <tr>
			   <td>Code Units (bytes)</td>
			   <td><code>0x41</code></td>
			   <td><code>0xC3 0x80</code></td>
		   </tr>
		   <tr>
			   <td>Grapheme</td>
			   <td class=bigtext>&#x928;</td>
			   <td class=bigtext>&#x1F46A;</td>
		   </tr>
		   <tr>
			   <td>Code Point</td>
			   <td><code>U+0928</code></td>
			   <td><code>U+1F46A</code></td>
		   </tr>
		   <tr>
			   <td>Code Units (bytes)</td>
			   <td><code>0xE0 0xA4 0xA8</code></td>
			   <td><code>0xF0 0x9F 0x91 0xAA</code></td>
		   </tr>
       </table>

    </aside>


<section id="char_def" class="subtopic">
    <h3>Choosing a definition of 'character'</h3>


     <p class="advisement" id="char_specific"><a class="self" href="#char_specific">&#x200B;</a>Specifications SHOULD use specific terms, when available, instead of the general term 'character'. <a href="https://www.w3.org/TR/charmod/#C067">more</a></p>
    <p class="advisement" id="char_define"><a class="self" href="#char_define">&#x200B;</a>When specifications use the term 'character' the specifications MUST define which meaning they intend, and  SHOULD explicitly define the term 'character' to mean a Unicode code point. <a href="https://www.w3.org/TR/charmod/#C010">more</a></p>
    <p class="advisement" id="char_physical_storage"><a class="self" href="#char_physical_storage">&#x200B;</a>Specifications, software and content MUST NOT require or depend on a one-to-one relationship between characters and units of physical storage. <a href="https://www.w3.org/TR/charmod/#C009">more</a></p>
   <p class="advisement" id="char_sounds"><a class="self" href="#char_sounds">&#x200B;</a>Specifications, software and content MUST NOT require or depend on a one-to-one correspondence between characters and the sounds of a language. <a href="https://www.w3.org/TR/charmod/#C001">more</a></p>
    <p class="advisement" id="char_display"><a class="self" href="#char_display">&#x200B;</a>Specifications, software and content MUST NOT require or depend on a one-to-one mapping between characters and units of displayed text. <a href="https://www.w3.org/TR/charmod/#C002">more</a></p>
    <p class="advisement" id="char_keystroke"><a class="self" href="#char_keystroke">&#x200B;</a>Specifications and software MUST NOT require nor depend on a single keystroke resulting in a single character, nor that a single character be input with a single keystroke (even with modifiers), nor that keyboards are the same all over the world. <a href="https://www.w3.org/TR/charmod/#C005">more</a></p>

  <section class="links"><h4>Links</h4>
  <section class="howto"><h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Perceptions">Perceptions of Characters </a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
  </section>
</section>
<section class="xref"><h4>See also</h4>
        <p><a href="#char_string">Defining 'string'</a>.</p>
</section>
</section>


  <section id="char_referencemodel" class="subtopic">
    <h3>Defining a Reference Processing Model</h3>
    <p class="advisement" id="char_single_enc"><a class="self" href="#char_single_enc">&#x200B;</a>Textual data objects defined by protocol or format specifications MUST be in a single character encoding. <a href="https://www.w3.org/TR/charmod/#C013">more</a></p>
    <p class="advisement" id="char_rpm"><a class="self" href="#char_rpm">&#x200B;</a>All specifications that involve processing of text MUST specify the processing of text according to the Reference Processing Model described by the rest of the recommendations in this list. <a href="https://www.w3.org/TR/charmod/#C014">more</a></p>
    <p class="advisement" id="char_unicode_chars"><a class="self" href="#char_unicode_chars">&#x200B;</a>Specifications MUST define text in terms of Unicode characters, not bytes or glyphs. <a href="https://www.w3.org/TR/charmod/#C014">more</a></p>
    <p class="advisement" id="char_transcode"><a class="self" href="#char_transcode">&#x200B;</a>For their textual data objects specifications MAY allow use of any character encoding which can be transcoded to a Unicode encoding form. <a href="https://www.w3.org/TR/charmod/#C014">more</a></p>
    <p class="advisement" id="char_as_unicode"><a class="self" href="#char_as_unicode">&#x200B;</a>Specifications MAY choose to disallow or deprecate some character encodings and to make others mandatory. Independent of the actual character encoding, the specified behavior MUST be the same as if the processing happened as follows: (a) The character encoding of any textual data object received by the application implementing the specification MUST be determined and the data object MUST be interpreted as a sequence of Unicode characters - this MUST be equivalent to transcoding the data object to some Unicode encoding form, adjusting any character encoding label if necessary, and receiving it in that Unicode encoding form, (b) All processing MUST take place on this sequence of Unicode characters, (c) If text is output by the application, the sequence of Unicode characters MUST be encoded using a character encoding chosen among those allowed by the specification. <a href="https://www.w3.org/TR/charmod/#C014">more</a></p>
    <p class="advisement" id="char_different_enc"><a class="self" href="#char_different_enc">&#x200B;</a>If a specification is such that multiple textual data objects are involved (such as an XML document referring to external parsed entities), it MAY choose to allow these data objects to be in different character encodings. In all cases, the Reference Processing Model MUST be applied to all textual data objects. <a href="https://www.w3.org/TR/charmod/#C014">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Characters">Digital Encoding of Characters </a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
    </section>
    <section class="xref">
      <h4>See also</h4>
      <p><a href="#char_ranges">Including and excluding character ranges</a>.</p>
    </section>
  </section>


  <section id="char_ranges" class="subtopic">
    <h3>Including and excluding character ranges </h3>
    <p class="advisement" id="char_exclude"><a class="self" href="#char_exclude">&#x200B;</a>Specifications SHOULD NOT arbitrarily exclude code points from the full range of Unicode code points from U+0000 to U+10FFFF inclusive. <a href="https://www.w3.org/TR/charmod/#C070">more</a></p>
    <p class="advisement" id="char_10ffff"><a class="self" href="#char_10ffff">&#x200B;</a>Specifications MUST NOT allow code points above U+10FFFF. <a href="https://www.w3.org/TR/charmod/#C077">more</a></p>
    <p class="advisement" id="char_internal_use"><a class="self" href="#char_internal_use">&#x200B;</a>Specifications SHOULD NOT allow the use of codepoints reserved by Unicode for internal use. <a href="https://www.w3.org/TR/charmod/#C079">more</a></p>
    <p class="advisement" id="char_surrogate"><a class="self" href="#char_surrogate">&#x200B;</a>Specifications MUST NOT allow the use of surrogate code points. <a href="https://www.w3.org/TR/charmod/#C078">more</a></p>
    <p class="advisement" id="char_compatibility"><a class="self" href="#char_compatibility">&#x200B;</a>Specifications SHOULD exclude compatibility characters in the syntactic elements (markup, delimiters, identifiers) of the formats they define. <a href="https://www.w3.org/TR/charmod/#C050">more</a></p>
<p class="advisement" id="char_user_defined_values"><a class="self" href="#char_user_defined_values">&#x200B;</a>Specifications SHOULD allow the full range of Unicode for user-defined values. <a href="https://www.w3.org/TR/charmod-norm/#sec_unicode_cs">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Characters">Digital Encoding of Characters </a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
    </section>
    <section class="xref">
      <h4>See also</h4>
      <p><a href="#char_pua">Using the Private Use Area</a>.</p>
    </section>
  </section>


  <section id="char_pua" class="subtopic">
    <h3>Using the Private Use Area</h3>
    <p class="advisement" id="char_not_pua"><a class="self" href="#char_not_pua">&#x200B;</a>Specifications MUST NOT require the use of private use area characters with particular assignments. <a href="https://www.w3.org/TR/charmod/#C038">more</a></p>
    <p class="advisement" id="char_pua_mechanisms"><a class="self" href="#char_pua_mechanisms">&#x200B;</a>Specifications MUST NOT require the use of mechanisms for defining agreements of private use code points. <a href="https://www.w3.org/TR/charmod/#C039">more</a></p>
    <p class="advisement" id="char_pua_allow"><a class="self" href="#char_pua_allow">&#x200B;</a>Specifications and implementations SHOULD NOT disallow the use of private use code points by private agreement. <a href="https://www.w3.org/TR/charmod/#C040">more</a></p>
    <p class="advisement" id="char_symbols"><a class="self" href="#char_symbols">&#x200B;</a>Specifications MAY define markup to allow the transmission of symbols not in Unicode or to identify specific variants of Unicode characters. <a href="https://www.w3.org/TR/charmod/#C041">more</a></p>
    <p class="advisement" id="char_pictures"><a class="self" href="#char_pictures">&#x200B;</a>Specifications SHOULD allow the inclusion of or reference to pictures and graphics where appropriate, to eliminate the need to (mis)use character-oriented mechanisms for pictures or graphics. <a href="https://www.w3.org/TR/charmod/#C068">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-PrivateUse">Private use code points</a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
    </section>
    <section class="xref">
      <h4>See also</h4>
      <p><a href="#char_ranges">Including and excluding character ranges</a>.</p>
    </section>
  </section>


  <section id="char_choosing" class="subtopic">
    <h3>Choosing character encodings</h3>
    <p class="advisement" id="char_identification"><a class="self" href="#char_identification">&#x200B;</a>Specifications MUST either specify a unique character encoding, or provide character encoding identification mechanisms such that the encoding of text can be reliably identified. <a href="https://www.w3.org/TR/charmod/#C015">more</a></p>
    <p class="advisement" id="char_unique_for_new"><a class="self" href="#char_unique_for_new">&#x200B;</a>When designing a new protocol, format or API, specifications SHOULD require a unique character encoding. <a href="https://www.w3.org/TR/charmod/#C016">more</a></p>
    <p class="advisement" id="char_enc_rules"><a class="self" href="#char_enc_rules">&#x200B;</a>When basing a protocol, format, or API on a protocol, format, or API that already has rules for character encoding, specifications SHOULD use rather than change these rules. <a href="https://www.w3.org/TR/charmod/#C017">more</a></p>
    <p class="advisement" id="char_use_utf8"><a class="self" href="#char_use_utf8">&#x200B;</a>When a unique character encoding is required, the character encoding MUST be UTF-8, UTF-16 or UTF-32. <a href="https://www.w3.org/TR/charmod/#C018">more</a></p>
    <p>This guideline needs further consideration: utf-16 and utf-32 are not recommended these days. UTF-8 is the recommended encoding.</p>
    <p class="advisement" id="char_charset"><a class="self" href="#char_charset">&#x200B;</a>Specifications SHOULD avoid using the terms 'character set' and 'charset' to refer to a character encoding, except when the latter is used to refer to the MIME charset parameter or its IANA-registered values. The term 'character encoding', or in specific cases the terms 'character encoding form' or 'character encoding scheme', are RECOMMENDED. <a href="https://www.w3.org/TR/charmod/#C020">more</a></p>
    <p class="advisement" id="char_iana"><a class="self" href="#char_iana">&#x200B;</a>If the unique encoding approach is not taken, specifications SHOULD require the use of the IANA charset registry names, and in particular the names identified in the registry as 'MIME preferred names', to designate character encodings in protocols, data formats and APIs. <a href="https://www.w3.org/TR/charmod/#C021">more</a></p>
    <p>This guideline needs further consideration: the list of character encodings recommended for Web specifications is listed in the Encoding specification.</p>
    <p class="advisement" id="char_non_iana"><a class="self" href="#char_non_iana">&#x200B;</a>Character encodings that are not in the IANA registry SHOULD NOT be used, except by private agreement. <a href="https://www.w3.org/TR/charmod/#C022">more</a></p>
    <p class="advisement" id="char_x"><a class="self" href="#char_x">&#x200B;</a>If an unregistered character encoding is used, the convention of using 'x-' at the beginning of the name MUST be followed. <a href="https://www.w3.org/TR/charmod/#C023">more</a></p>
    <p class="advisement" id="char_not_unique"><a class="self" href="#char_not_unique">&#x200B;</a>If the unique encoding approach is not chosen, specifications MUST designate at least one of the UTF-8 and UTF-16 encoding forms of Unicode as admissible character encodings and SHOULD choose at least one of UTF-8 or UTF-16 as required encoding forms (encoding forms that MUST be supported by implementations of the specification). <a href="https://www.w3.org/TR/charmod/#C026">more</a></p>
    <p class="advisement" id="char_default"><a class="self" href="#char_default">&#x200B;</a>Specifications that require a default encoding MUST define either UTF-8 or UTF-16 as the default, or both if they define suitable means of distinguishing them. <a href="https://www.w3.org/TR/charmod/#C027">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Encodings">Choice and identification of code points</a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
      <section class="background">
        <h5>Background reading</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/International/questions/qa-doc-charset">Document character set</a></p>
            <p class="desc">What is the 'Document Character Set' for XML and HTML, and how does it relate to the encodings I use for my documents? </p>
          </li>
        </ul>
      </section>
    </section>
  </section>



  <section id="char_identifying" class="subtopic">
    <h3>Identifying character encodings</h3>
    <p class="advisement" id="char_heuristics"><a class="self" href="#char_heuristics">&#x200B;</a>Specifications MUST NOT propose the use of heuristics to determine the encoding of data. <a href="https://www.w3.org/TR/charmod/#C028">more</a></p>
    <p class="advisement" id="char_conflict"><a class="self" href="#char_conflict">&#x200B;</a>Specifications MUST define conflict-resolution mechanisms (e.g. priorities) for cases where there is multiple or conflicting information about character encoding. <a href="https://www.w3.org/TR/charmod/#C035">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Encodings">Choice and identification of code points</a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
    </section>
  </section>


  <section id="char_escapes" class="subtopic">
    <h3>Designing character escapes</h3>
    <p class="advisement" id="char_escaping"><a class="self" href="#char_escaping">&#x200B;</a>Specifications should provide a mechanism for escaping characters, particularly those which are invisible or ambiguous. <a href="https://w3c.github.io/bp-i18n-specdev/#char_heuristics">more</a></p>
      <p>It is generally recommended that character escapes be provided so that difficult to enter or edit sequences can be introduced using a plain text editor. Escape sequences are particularly useful for invisible or ambiguous Unicode characters, including zero-width spaces, soft-hyphens, various bidi controls, mongolian vowel separators, etc. </p>
      <p>For advice on use of escapes in markup, but which is mostly generalisable to other formats, see <a href="https://www.w3.org/International/questions/qa-escapes">Using character escapes in markup and CSS</a>.</p>
    <p class="advisement" id="char_esc_new"><a class="self" href="#char_esc_new">&#x200B;</a>Specifications SHOULD NOT invent a new escaping mechanism if an appropriate one already exists. <a href="https://www.w3.org/TR/charmod/#C042">more</a></p>
    <p class="advisement" id="char_esc_alternates"><a class="self" href="#char_esc_alternates">&#x200B;</a>The number of different ways to escape a character SHOULD be minimized (ideally to one). <a href="https://www.w3.org/TR/charmod/#C043">more</a></p>
    <p class="advisement" id="char_esc_end"><a class="self" href="#char_esc_end">&#x200B;</a>Escape syntax SHOULD require either explicit end delimiters or a fixed number of characters in each character escape. Escape syntaxes where the end is determined by any character outside the set of characters admissible in the character escape itself SHOULD be avoided. <a href="https://www.w3.org/TR/charmod/#C044">more</a></p>
    <p class="advisement" id="char_esc_hex"><a class="self" href="#char_esc_hex">&#x200B;</a>Whenever specifications define character escapes that allow the representation of characters using a number, the number MUST represent the Unicode code point of the character and SHOULD be in hexadecimal notation. <a href="https://www.w3.org/TR/charmod/#C045">more</a></p>
    <p class="advisement" id="char_esc_acceptable"><a class="self" href="#char_esc_acceptable">&#x200B;</a>Escaped characters SHOULD be acceptable wherever their unescaped forms are; this does not preclude that syntax-significant characters, when escaped, lose their significance in the syntax. In particular, if a character is acceptable in identifiers and comments, then its escaped form should also be acceptable. <a href="https://www.w3.org/TR/charmod/#C046">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Escaping">Character escaping</a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/#sec-Characters">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
    </section>
  </section>


<section id="char_storing" class="subtopic">
    <h3>Storing text</h3>
    <p class="advisement" id="char_storing_logical"><a class="self" href="#char_storing_logical">&#x200B;</a>Protocols, data formats and APIs MUST store, interchange or process text data in logical order. <a href="https://www.w3.org/TR/charmod/#C003">more</a></p>
     <p class="advisement" id="char_logical_storage"><a class="self" href="#char_logical_storage">&#x200B;</a>Independent of whether some implementation uses logical selection or visual selection, characters selected MUST be kept in logical order in storage. <a href="https://www.w3.org/TR/charmod/#C075">more</a></p>
   <p class="advisement" id="char_storing_discontiguous"><a class="self" href="#char_storing_discontiguous">&#x200B;</a>Specifications of protocols and APIs that involve selection of ranges SHOULD provide for discontiguous logical selections, at least to the extent necessary to support implementation of visual selection on screen on top of those protocols and APIs. <a href="https://www.w3.org/TR/charmod/#C004">more</a></p>


    <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-LogicalOrder">Visual rendering and logical order</a></p>
            <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/">Character Model for the World Wide Web</a>.</p>
          </li>
        </ul>
      </section>
    </section>
</section>
<section id="char_string" class="subtopic">
<h3>Defining 'string'</h3>
      <p class="advisement" id="char_string_byte"><a class="self" href="#char_string_byte">&#x200B;</a>Specifications SHOULD NOT define a string as a 'byte string'. <a href="https://www.w3.org/TR/charmod/#C011">more</a></p>
      <p class="advisement" id="char_string_char"><a class="self" href="#char_string_char">&#x200B;</a>The 'character string' definition SHOULD be used by most specifications. <a href="https://www.w3.org/TR/charmod/#C012">more</a></p>

      <section class="links">
        <h4>Links</h4>
        <section class="howto">
          <h5>How to's</h5>
          <ul>
            <li class="w3">
              <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-Strings">String concepts</a></p>
              <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/">Character Model for the World Wide Web</a>.</p>
            </li>
          </ul>
        </section>
      </section>
      <section class="xref">
        <h4>See also</h4>
        <p><a href="#char_indexing">Indexing strings </a> and <a href="#char_def">Choosing a definition of 'character'</a>.</p>
      </section>
</section>
<section id="char_ref_Unicode_char" class="subtopic">
<h3>Referring to Unicode characters</h3>
      <p class="advisement" id="char_ref_Uchar"><a class="self" href="#char_ref_Uchar">&#x200B;</a>Use U+XXXX syntax to represent Unicode code points in the specification. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#char_ref_Uchar">more</a></p>
      <p>The U+XXXX format is well understood when referring to Unicode code points in a specification. These are space separated when appearing in a sequence. No additional decoration is needed. Note that a code point may contain four, five, or six hexadecimal digits. When fewer than four digits are needed, the code point number is zero filled. E.g. U+0020.</p>
</section>


    <section id="char_unicoderef" class="subtopic">
      <h3>Referencing the Unicode Standard</h3>
      <p class="advisement" id="char_unicoderef_do"><a class="self" href="#char_unicoderef_do">&#x200B;</a>Since specifications in general need both a definition for their characters and the semantics associated with these characters, specifications SHOULD include a reference to the Unicode Standard, whether or not they include a reference to ISO/IEC 10646. <a href="https://www.w3.org/TR/charmod/#C062">more</a></p>
      <p class="advisement" id="char_unicoderef_generic"><a class="self" href="#char_unicoderef_generic">&#x200B;</a>A generic reference to the Unicode Standard MUST be made if it is desired that characters allocated after a specification is published are usable with that specification. A specific reference to the Unicode Standard MAY be included to ensure that functionality depending on a particular version is available and will not change over time. <a href="https://www.w3.org/TR/charmod/#C063">more</a></p>
      <p class="advisement" id="char_unicoderef_latest"><a class="self" href="#char_unicoderef_latest">&#x200B;</a>All generic references to the Unicode Standard MUST refer to the latest version of the Unicode Standard available at the date of publication of the containing specification. <a href="https://www.w3.org/TR/charmod/#C064">more</a></p>
      <p class="advisement" id="char_unicoderef_10646"><a class="self" href="#char_unicoderef_10646">&#x200B;</a>All generic references to ISO/IEC 10646 MUST refer to the latest version of ISO/IEC 10646 available at the date of publication of the containing specification. <a href="https://www.w3.org/TR/charmod/#C065">more</a></p>

      <section class="links">
        <h4>Links</h4>
        <section class="howto">
          <h5>How to's</h5>
          <ul>
            <li class="w3">
              <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-RefUnicode">Referencing the Unicode Standard and ISO/IEC 10646</a></p>
              <p class="desc">In W3C Recommendation, <a href="https://www.w3.org/TR/charmod/">Character Model for the World Wide Web</a>.</p>
            </li>
          </ul>
        </section>
      </section>
    </section>


  </section>







<section id="operations" class="topic">
<h2>Text-processing</h2>

<p>In this section:</p>
	<ul class="summary">
	<li><a href="#char_indexing"></a></li>
	<li><a href="#string_match"></a></li>
	<li><a href="#text_n11n"></a></li>
	<li><a href="#text_case"></a></li>
	<li><a href="#char_truncation"></a></li>
	<li><a href="#char_sort"></a></li>
	</ul>


<section id="char_indexing" class="subtopic">
      <h3>Choosing text units for segmentation, indexing, etc.</h3>

      <p class="advisement" id="char_index_char"><a class="self" href="#char_index_char">&#x200B;</a>The character string is RECOMMENDED as a basis for string indexing. <a href="https://www.w3.org/TR/charmod/#C051">more</a></p>

      <p class="advisement" id="char_index_grapheme"><a class="self" href="#char_index_grapheme">&#x200B;</a>Grapheme clusters MAY be used as a basis for string indexing in applications where user interaction is the primary concern. <a href="https://www.w3.org/TR/charmod/#C071">more</a></p>

<p class="advisement" id="char_index_grapheme_plus"><a class="self" href="#char_index_grapheme_plus">&#x200B;</a>Specifications that define indexing in terms of grapheme clusters MUST either: (a) define grapheme clusters in terms of extended grapheme clusters as defined in Unicode Standard Annex #29, Text Boundaries [UTR #29], or (b) define specifically how tailoring is applied to the indexing operation. <a href="https://www.w3.org/TR/charmod/#C074">more</a></p>

<p class="advisement" id="char_index_byte"><a class="self" href="#char_index_byte">&#x200B;</a>The use of byte strings for indexing is NOT RECOMMENDED. <a href="https://www.w3.org/TR/charmod/#C072">more</a></p>

       <p class="advisement" id="char_index_codeunit"><a class="self" href="#char_index_codeunit">&#x200B;</a>A UTF-16 code unit string is NOT RECOMMENDED as a basis for string indexing, even if this results in a significant improvement in the efficiency of internal operations when compared to the use of character string. <a href="https://www.w3.org/TR/charmod/#C052">more</a></p>

     <p class="advisement" id="char_index_substrings"><a class="self" href="#char_index_substrings">&#x200B;</a>Specifications that need a way to identify substrings or point within a string SHOULD consider ways other than string indexing to perform this operation. <a href="https://www.w3.org/TR/charmod/#C053">more</a></p>
      <p class="advisement" id="char_index_counting"><a class="self" href="#char_index_counting">&#x200B;</a>Specifications SHOULD understand and process single characters as substrings, and treat indices as boundary positions between counting units, regardless of the choice of counting units. <a href="https://www.w3.org/TR/charmod/#C055">more</a></p>
      <p class="advisement" id="char_index_api"><a class="self" href="#char_index_api">&#x200B;</a>Specifications of APIs SHOULD NOT specify single characters or single 'units of encoding' as argument or return types. <a href="https://www.w3.org/TR/charmod/#C056">more</a></p>
      <p class="advisement" id="char_index_0"><a class="self" href="#char_index_0">&#x200B;</a>When the positions between the units are counted for string indexing, starting with an index of 0 for the position at the start of the string is the RECOMMENDED solution, with the last index then being equal to the number of counting units in the string. <a href="https://www.w3.org/TR/charmod/#C057">more</a></p>

<section class="links">
<h4>Links</h4>
<section class="howto">
<h5>How to's</h5>
<ul>
<li class="w3">
<p class="link"><a href="https://www.w3.org/TR/charmod/">Character Model for the World Wide Web: Fundamentals</a></p>
<ul>
<li class="sub">
<p class="link"><a href="https://www.w3.org/TR/charmod/#sec-stringIndexing">String indexing</a></p>
</li>
</ul></li>
</ul>
</section>
</section>

<section class="xref">
<h4>See also</h4>
        <p><a href="#char_string"></a>.</p>
</section>
</section>





  <section id="string_match" class="subtopic">
    <h3>Matching string identity for identifiers and syntactic content</h3>

    <p class="advisement" id="string_match_steps"><a class="self" href="#string_match_steps">&#x200B;</a>String identity matching for identifiers and syntactic content should involve the following steps: (a) Ensure the strings to be compared constitute a sequence of Unicode code points (b) Expand all character escapes and includes (c) Perform any appropriate case-folding and Unicode normalization step (d) Perform any additional matching tailoring specific to the specification, and (e) Compare the resulting sequences of code points for identity. <a href="https://www.w3.org/TR/charmod-norm/#matchingAlgorithm">more</a></p>

    <p class="advisement" id="string_match_default"><a class="self" href="#string_match_default">&#x200B;</a>The default recommendation for matching strings in identifiers and syntactic content is to do no normalization (ie. case folding or Unicode Normalization) of content. <a href="https://www.w3.org/TR/charmod-norm/#performNorm">more</a></p>

    <p class="advisement" id="string_match_other_normalization"><a class="self" href="#string_match_other_normalization">&#x200B;</a><a class="termref" href="https://www.w3.org/TR/charmod-norm/#ASCIIFoldNormalizationStep">'ASCII case fold'</a> and <a href="https://www.w3.org/TR/charmod-norm/#CanonicalFoldNormalizationStep" class="termref">'Unicode canonical case fold'</a> approaches should only be used in special circumstances. <a href="https://www.w3.org/TR/charmod-norm/#performNorm">more</a></p>

    <p class="advisement" id="string_match_compatibility"><a class="self" href="#string_match_compatibility">&#x200B;</a>A <a href="https://www.w3.org/TR/charmod-norm/#CompatibilityFoldNormalizationStep" class="termref">'Unicode compatibility case fold'</a> approach should not be used. <a href="https://www.w3.org/TR/charmod-norm/#performNorm">more</a></p>

    <p class="advisement" id="string_match_boundaries"><a class="self" href="#string_match_boundaries">&#x200B;</a>Specifications of vocabularies MUST define the boundaries between syntactic content and character data as well as entity boundaries (if the language has any include mechanism). <a href="https://www.w3.org/TR/charmod-norm/#normalizationChoice">more</a></p>


    <section class="links">
      <h4>Links</h4>

	<section class="howto">
	  <h5>How to's</h5>
        <ul>
			<li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/">Character Model for the World Wide Web: String Matching</a></p>
			<ul>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#identityMatching">String Matching of Syntactic Content in Document Formats and Protocols</a></p>
          </li>
</ul>
</li>
        </ul>
		</section>
   </section>

<section class="xref">
<h4>See also</h4>
<p><a href="#text_n11n"></a>.</p>
<p><a href="#text_case"></a>.</p>
</section>
</section>






  <section id="text_n11n" class="subtopic">
    <h3>Working with  Unicode Normalization</h3>

	<p class="advisement" id="text_n11n_default"><a class="self" href="#text_n11n_default">&#x200B;</a>Specifications SHOULD NOT specify a Unicode normalization form for encoding, storage, or interchange of a given vocabulary. <a href="https://www.w3.org/TR/charmod-norm/#normalizationChoice">more</a></p>
		

    <p class="advisement" id="text_n11n_no_change"><a class="self" href="#text_n11n_no_change">&#x200B;</a>Implementations MUST NOT alter the normalization form of syntactic or natural language content being exchanged, read, parsed, or processed except when required to do so as a side-effect of text transformation such as transcoding the content to a Unicode character encoding, case folding, or other user-initiated change, as consumers or the content itself might depend on the de-normalized representation. <a href="https://www.w3.org/TR/charmod-norm/#normalizationChoice">more</a></p>

<p class="advisement" id="text_n11n_compatibility"><a class="self" href="#text_n11n_compatibility">&#x200B;</a>Specifications SHOULD NOT specify compatibility normalization forms (NFKC, NFKD). <a href="https://www.w3.org/TR/charmod-norm/#normalizationChoice">more</a></p>

<p class="advisement" id="text_n11n_security"><a class="self" href="#text_n11n_security">&#x200B;</a>Specifications MUST document or provide a health-warning if canonically equivalent but disjoint Unicode character sequences represent a security issue. <a href="https://www.w3.org/TR/charmod-norm/#normalizationChoice">more</a></p>

    <p class="advisement" id="text_n11n_operations"><a class="self" href="#text_n11n_operations">&#x200B;</a>Where operations can produce denormalized output from normalized text input, specifications MUST define whether the resulting output is required to be normalized or not. Specifications MAY state that performing normalization is optional for some operations; in this case the default SHOULD be that normalization is performed, and an explicit option SHOULD be used to switch normalization off. <a href="https://www.w3.org/TR/charmod-norm/#normalizing-spec">more</a></p>

    <p class="advisement" id="text_n11n_implementation"><a class="self" href="#text_n11n_implementation">&#x200B;</a>Specifications that require normalization MUST NOT make the implementation of normalization optional. <a href="https://www.w3.org/TR/charmod-norm/#normalizing-spec">more</a></p>

    <p class="advisement" id="text_n11n_sensitive_operations"><a class="self" href="#text_n11n_sensitive_operations">&#x200B;</a>Normalization-sensitive operations MUST NOT be performed unless the implementation has first either confirmed through inspection that the text is in normalized form or it has re-normalized the text itself. Private agreements MAY be created within private systems which are not subject to these rules, but any externally observable results MUST be the same as if the rules had been obeyed. <a href="https://www.w3.org/TR/charmod-norm/#normalizing-spec">more</a></p>
	
    <p class="advisement" id="text_n11n_mechanism"><a class="self" href="#text_n11n_mechanism">&#x200B;</a>A normalizing text-processing component which modifies text and performs normalization-sensitive operations MUST behave as if normalization took place after each modification, so that any subsequent normalization-sensitive operations always behave as if they were dealing with normalized text. <a href="https://www.w3.org/TR/charmod-norm/#normalizing-spec">more</a></p>
    
    <section id="spec_n11n" class="subtopic">
	<h4>Specifying Unicode Normalization</h4>
	
	<p class="advisement" id="text_n11n_specification"><a class="self" text="#text_n11n_specification">&#x200B;</a>Specifications that perform comparison or matching of string values SHOULD specify the appropriate note or warning regarding Unicode normalization.</p>
    
    <p>The use or adoption of Unicode Normalization in a specification is usually part of defining how <a href="#string_match_steps">matching</a> takes place in a given format or protocol. To help specification authors and implementers understand some of the complexity involved, the Internationalization Working Group has developed a document describing the considerations for the matching and comparison of strings: <cite class="link"><a href="https://www.w3.org/TR/charmod-norm/">Character Model for the World Wide Web: String Matching</a></cite> [[CHARMOD-NORM]].</p>
    
    <p>One of the choices specifications need to make is whether (or not) to require Unicode Normalization as part of matching various "values" defined as part of the specification's vocabulary. Values are commonly part of a document format or protocol's syntax, and include such things as: attribute names or values, element names or values, IDs, and so forth. Specifications that follow the <a href="#text_n11n_default">recommendation</a> to <em>not</em> employ normalization as part of matching should include the following Note as a reminder to content authors.</p>
        
    <div class="example" id="n11n_note_figure">
	   <p>Example note. Necessarily this version is non-specific about what constitutes "values": specifications may wish to be more specific.</p>
	   <div class="example_div">
           <p class="note example_note">This specification does not permit Unicode normalization of values for the purposes of comparison. Values that are visually and semantically identical but use different Unicode character sequences will not match. Content authors are advised to use the same encoding sequence consistently or to avoid potentially troublesome characters when choosing values. For more information, see [[CHARMOD-NORM]].</p>
       </div>
    </div>
    
    <p>Specifications that choose to require require normalization as part of string matching should include the following warning:</p>
    
    <div class="example" id="n11n_warning_figure">
     <p>Example warning. Necessarily this version is non-specific about what constitutes "values": specifications may wish to be more specific.</p>
     
       <div class="example_div">
         <p class="warning">This specification applies Unicode normalization during the matching of values. This can have an effect on the appearance and meaning of the affected text. For more information, see [[CHARMOD-NORM]].</p> 
       </div>
    </div>
    
    <p>Contact the I18N WG for alternatives or assistance if the above do not meet your needs or you're not sure about usage.</p>
    
  </section>
    
    
<section class="links">
  <h4>Links</h4>
      <section class="background">
        <h5>Background reading</h5>
        <ul>
			<li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/">Character Model for the World Wide Web: String Matching</a></p>
			<ul>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#unicodeNormalization">Unicode Normalization</a></p>
          </li>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#normalizationLimitations">Identical-Appearing Characters and the Limitations of Normalization</a></p>
          </li>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#normalizationAndCasefold">Interaction of Normalization and Case Folding</a></p>
          </li>
		  </ul></li>
        </ul>
      </section>
	  <section class="howto">
        <h5>How to's</h5>
        <ul>
			<li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/">Character Model for the World Wide Web: String Matching</a></p>
			<ul>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#performNorm">Performing the Appropriate Normalization Step</a></p>
          </li>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#normalizationChoice">Additional Considerations for Normalization</a></p></li>
		  </ul></li>
        </ul>
		</section>
  </section>
  </section>




  <section id="text_case" class="subtopic">
    <h3>Case folding</h3>

    <p class="advisement" id="text_case_options"><a class="self" href="#text_case_options">&#x200B;</a>Specifications and implementations that define string matching as part of the definition of a format, protocol, or formal language (which might include operations such as parsing, matching, tokenizing, etc.) MUST define the criteria and matching forms used. These MUST be one of: (a) case-sensitive (b) Unicode case-insensitive using Unicode full case-folding (c) ASCII case-insensitive.</p>

<p class="advisement" id="text_case_sensitive"><a class="self" href="#text_case_sensitive">&#x200B;</a>Case-sensitive matching is RECOMMENDED for matching syntactic content, including user-defined values. <a href="https://www.w3.org/TR/charmod-norm/#sec_case_sensitive">more</a></p>

  <p class="advisement" id="text_case_unicode_full"><a class="self" href="#text_case_unicode_full">&#x200B;</a>Specifications that define case-insensitive matching in vocabularies that include more than the Basic Latin (ASCII) range of Unicode MUST specify Unicode full casefold matching. <a href="https://www.w3.org/TR/charmod-norm/#sec_unicode_cs">more</a></p>

<p class="advisement" id="text_case_asciici"><a class="self" href="#text_case_asciici">&#x200B;</a>Specifications that define case-insensitive matching in vocabularies limited to the Basic Latin (ASCII) subset of Unicode MAY specify ASCII case-insensitive matching. <a href="https://www.w3.org/TR/charmod-norm/#sec_ascii_cs">more</a></p>

<p class="advisement" id="text_case_nonascii"><a class="self" href="#text_case_nonascii">&#x200B;</a>If language-sensitive case-sensitive matching is specified, Unicode case mappings SHOULD be tailored according to language and the source of the language used for each tailoring MUST be specified. <a href="https://www.w3.org/TR/charmod-norm/#sec_language_tailoring">more</a></p>

    <p class="advisement" id="text_case_vocabularies"><a class="self" href="#text_case_vocabularies">&#x200B;</a>Specifications that define case-insensitive matching in vocabularies SHOULD NOT specify language-sensitive case-insensitive matching. <a href="https://www.w3.org/TR/charmod-norm/#sec_language_tailoring">more</a></p>

	<section class="links">
  <h4>Links</h4>
      <section class="background">
        <h5>Background reading</h5>
        <ul>
			<li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/">Character Model for the World Wide Web: String Matching</a></p>
			<ul>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#definitionCaseFolding">Case Mapping and Case Folding</a></p>
          </li>
</ul></li>
        </ul>
      </section>
	  <section class="howto">
        <h5>How to's</h5>
        <ul>
			<li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/">Character Model for the World Wide Web: String Matching</a></p>
			<ul>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod-norm/#handlingCaseFolding">Additional Considerations for Case Folding</a></p></li>
		  </ul></li>
        </ul>
		</section>
  </section>
</section>





<section id="char_truncation" class="subtopic">
   <h3>Truncating or limiting the length of strings</h3>

    <p>Some specifications, formats, or protocols or their implementations need to specify limits for the size of a given data structure or text field. This could be due to many reasons, such as limits on processing, memory, data structure size, and so forth. When selecting or specifying limits on the length of a given string, specifications or implementations need to ensure that they do not cause corruption in the text.</p>

    <p class="advisement" id="char_trunc_no_limit"><a class="self" href="#char_trunc_no_limit">&#x200B;</a>Specifications SHOULD NOT limit the size of data fields unless there is a specific practical or technical limitation.</p>

    <p>There are many reasons why a length limit might be needed in a specification or format. Generally length limits correspond to underlying limits in the implementation, such as the use of fixed-size fields in a database or data store, the desire to fit into practical boundaries such as packet size, or some other implementation detail related to storage allocation or efficiency.</p>

    <p>When truncating strings, it's necessary to decide what units to use when counting the size of the string. In many cases this is beyond the control of the specification, since the truncation is occuring for some preordained reason. However, when the choice is available, some general guidelines can be applied.</p>

    <p>If the limitation is related to the number of display positions, the grapheme count usually corresponds most closely to the expected limit. Note that proportional width fonts, combining marks, complex scripts, and many other factors complicate counting "screen positions". In Web pages, for example, the CSS <kbd>text-overflow</kbd> property provides visual truncation without disturbing the content of the text. Attempts to estimate the size of a given piece of text based on the number of Unicode code points or even the number of grapheme clusters is mostly futile.</p>

    <p>Otherwise most limits are expressed in terms of code points in Unicode or code units (such as bytes) in a specific character encoding. Code points provides the best user experience, since all Unicode code points are treated identically: if text is truncated after 40 code points, all languages and scripts get the same number of code points to work with. By contrast, when the size limit is expressed in code units such as bytes in UTF-8, users who write in a language that mostly uses ASCII letters get many more characters (code points) for a given size limit than user's whose language is mostly made up of characters that take 2-, 3-, or 4-bytes per code point.</p>

    <aside class=example>
		<h2>Text truncation in UTF-8</h2>
		<p>Below you can see the effect of truncating a given string of text encoded in UTF-8 on a 40-byte boundary. There are several things to notice here.</p>
		<p>First, the number of characters in the truncated string decreases as the number of bytes required per character goes up. So the Cyrillic string has half the number of characters as the ASCII string. The Chinese string has about 1/3 the number. And the emoji string has 1/4.</p>
		<p>Second, in two of the three examples, the text is truncated on a byte boundary in the middle of a character. The resulting "dangling byte" is rendered as U+FFFD and the byte sequence itself is not valid UTF-8. This can interfere with the validity of a given text file. Unlike many legacy character encodings, UTF-8 is highly patterned, so the the longest broken character sequence that can result from mid-character truncation is one character. By contrast, in many legacy encodings, a file or document containing a mid-character truncated string can be wholly changed or rendered unintelligible after that point.</p>
		<table class=truncExample>
		<tr>
			<th>Script</th>
			<th>Truncated Length<br>(code points)</th>
			<th>Avg. Bytes/Code Point</th>
			<th>Truncated Text<br>Byte Values</th>
		</tr>
		<tr>
			<td rowspan=2>ASCII
			<td rowspan=2>40</td>
			<td rowspan=2>1</td>
			<td><kbd>In the loveliest town of all, where the </kbd></td>
		</tr>
		<tr>
			<td><code>49 6E 20 74 68 65 20 6C 6F 76 65 6C 69 65 73 74 20 74 6F 77 6E 20 6F 66 20 61 6C 6C 2C 20 77 68 65 72 65 20 74 68 65 20</code></td>
		</tr>
		<tr>
			<td rowspan=2>Cyrillic</td>
			<td rowspan=2>22</td>
			<td rowspan=2>2</td>
			<td><kbd>В самом прекрасном го�</kbd></td>
	    </tr>
	    <tr>
			<td><code>D0 92 20 D1 81 D0 B0 D0 BC D0 BE D0 BC 20 D0 BF D1 80 D0 B5 D0 BA D1 80 D0 B0 D1 81 D0 BD D0 BE D0 BC 20 D0 B3 D0 BE <span style="color:red">D0</span></code></td>
	    </tr>
		<tr>
			<td rowspan=2>Han</td>
			<td rowspan=2>14</td>
			<td rowspan=2>3</td>
			<td><kbd lang="zh">在最美丽的城镇，那里的房屋�</kbd></td>
		</tr>
		<tr>
			<td><code>E5 9C A8 E6 9C 80 E7 BE 8E E4 B8 BD E7 9A 84 E5 9F 8E E9 95 87 EF BC 8C E9 82 A3 E9 87 8C E7 9A 84 E6 88 BF E5 B1 8B <span style="color:red">E5</span></code></td>
	    </tr>
		<tr>
			<td rowspan=2>Emoji</td>
			<td rowspan=2>10
			<td rowspan=2>4</td>
			<td><kbd>🙊🙁😢😠😧😎😽😉😄😮</kbd></td>
		</tr>
		<tr>
			<td><code>F0 9F 99 8A F0 9F 99 81 F0 9F 98 A2 F0 9F 98 A0 F0 9F 98 A7 F0 9F 98 8E F0 9F 98 BD F0 9F 98 89 F0 9F 98 84 F0 9F 98 AE</code></td>
		</tr>
		</table>
    </aside>

    <p class="advisement" id="char_trunc_units"><a class="self" href="#char_trunc_units">&#x200B;</a>Specifications that limit the length of a string MUST specify which type of unit (extended grapheme clusters, Unicode code points, or code units) the length limit uses.</p>
    <p class="advisement" id="char_trunc_unit_rec"><a class="self" href="#char_trunc_unit_rec">&#x200B;</a>Specifications that limit the length of a string SHOULD specify the length in terms of Unicode code points.</p>
    <p class="advisement" id="char_trunc_byte_boundary"><a class="self" href="#char_trunc_byte_boundary">&#x200B;</a>If a specification sets a length limit in code units (such as bytes), it MUST specify that truncation can only occur on code point boundaries.</p>
    <p class="advisement" id="char_trunc_indicator"><a class="self" href="#char_trunc_indicator">&#x200B;</a>If a specification specifies a length limit, it SHOULD specify that any string that is truncated include an indicator, such as ellipses, that the string has been altered.</p>
    <p class="advisement" id="char_trunc_min_size"><a class="self" href="#char_trunc_min_size">&#x200B;</a>When specifying a length limitation in code units (such as bytes), specifications SHOULD set the maximum length in a way that accommodates users whose language requires multibyte code unit sequences.</p>
</section>





<section id="char_sort" class="subtopic">
<h3>Specifying sort and search functionality</h3>
    <p class="advisement" id="char_sort_units"><a class="self" href="#char_sort_units">&#x200B;</a>Software that sorts or searches text for users SHOULD do so on the basis of appropriate collation units and ordering rules for the relevant language and/or application. <a href="https://www.w3.org/TR/charmod/#C006">more</a></p>
    <p class="advisement" id="char_sort_user"><a class="self" href="#char_sort_user">&#x200B;</a>Where searching or sorting is done dynamically, particularly in a multilingual environment, the 'relevant language' SHOULD be determined to be that of the current user, and may thus differ from user to user. <a href="https://www.w3.org/TR/charmod/#C007">more</a></p>
    <p class="advisement" id="char_sort_alternatives"><a class="self" href="#char_sort_alternatives">&#x200B;</a>Software that allows users to sort or search text SHOULD allow the user to select alternative rules for collation units and ordering. <a href="https://www.w3.org/TR/charmod/#C066">more</a></p>
    <p class="advisement" id="char_sort_anything"><a class="self" href="#char_sort_anything">&#x200B;</a>Specifications and implementations of sorting and searching algorithms SHOULD accommodate text that contains any character in Unicode. <a href="https://www.w3.org/TR/charmod/#C008">more</a></p>


    <section class="links">
      <h4>Links</h4>
 	  <section class="howto">
        <h5>How to's</h5>
        <ul>
			<li class="w3">
            <p class="link"><a href="https://www.w3.org/TR/charmod/">Character Model for the World Wide Web: Fundamentals</a></p>
			<ul>
           <li class="sub">
            <p class="link"><a href="https://www.w3.org/TR/charmod/#sec-CollationUnits">Units of collation</a></p>
          </li>
</ul>
</li>
        </ul>
		</section>
</section>
</section>
</section>






<section id="sec_resid_non_ascii" class="topic">
<h2>Resource identifiers</h2>

    <section id="sec_resid_basic" class="subtopic">
  <h3>Basics</h3>

<p class="advisement" id="resid_use_iris"><a href="#resid_use_iris">&#x200B;</a>Resource identifiers must permit the use of characters outside those of plain ASCII. <a href="https://github.com/w3c/web-annotation/issues/241">discussion</a></p>
<p class="advisement" id="resid_iri_conversion"><a class="self" href="#resid_iri_conversion">&#x200B;</a> Specifications MUST define when the conversion from IRI references to URI references (or subsets thereof) takes place, in accordance with Internationalized Resource Identifiers (IRIs). <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#resid_iri_conversion">more</a></p>
<p>Many current specifications already contain provisions in accordance with Internationalized Resource Identifiers (IRIs). For XML 1.0, see Section 4.2.2, External Entities. XML Schema Part 2: Datatypes provides the anyURI datatype (see Section 3.2.17). The XML Linking Language (XLink)  provides the href attribute (see Section 5.4, Locator Attribute).</p>
<p>Document formats should allow IRIs to be used; handlers for protocols that do not currently support IRIs can convert the IRI to a URI when the IRI is dereferenced.</p>
<section class="links">
  <h4>Links</h4>
  <section class="howto">
    <h5>How to's</h5>
    <ul>
      <li class="w3">
        <p class="link"><a href="http://www.w3.org/International/iri-edit/draft-duerst-iri-08.txt">Internationalized Resource Identifiers (IRIs)</a></p>
      </li>
    </ul>
  </section>
</section>
  </section>
  </section>



  <section id="markup" class="topic">
<h2>Markup &amp; syntax</h2>
<ul class="summary">
  <li><a href="#markup_attributes">Defining elements and attributes</a></li>
  <li><a href="#markup_identifiers">Defining identifiers</a></li>
  <li><a href="#markup_plaintext">Working with plain text</a></li>
</ul>

  <section id="markup_elements_attributes" class="subtopic"><h3>Defining elements and attributes</h3>
<p class="advisement" id="markup_attributes"><a class="self" href="#markup_attributes">&#x200B;</a>Do not define attribute values that will contain user readable content. Use elements for such content.  <a href="https://www.w3.org/TR/xml-i18n-bp/#DevAttributes">more</a></p>
<p class="advisement" id="markup_attributes_fallback"><a class="self" href="#markup_attributes_fallback">&#x200B;</a>If you do define attribute values containing user readable content, provide a means to indicate directional and language information for that text separately from the text contained in the element.</p>

<p class="advisement" id="markup_span"><a class="self" href="#markup_span">&#x200B;</a>Provide a way for authors to annotate arbitrary inline content using a <code class="kw" translate="no">span</code>-like element or construct.  <a href="https://www.w3.org/TR/xml-i18n-bp/#DevSpan">more</a></p>
</section>



  <section id="markup_identifiers" class="subtopic">
<h3>Defining identifiers</h3>

<p class="advisement" id="identifier_case"><a class="self" href="#identifier_case">&#x200B;</a>Identifiers should be case-sensitive.</p>
</section>


  <section id="markup_plaintext" class="subtopic">
    <h3>Working with plain text</h3>
<p class="advisement" id="plain_avoid"><a class="self" href="#plain_avoid">&#x200B;</a>Avoid natural language text in elements that only allow for plain text and in attribute values.</p>
<p class="advisement" id="plain_span"><a class="self" href="#plain_span">&#x200B;</a>Provide a span-like element that can be used for any text content to apply information needed for internationalization. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#plain_span">more</a></p>
<p>Internationalization information may include a change of language, bidirectional text behaviour changes, translate flags, etc.</p>
</section>

 </section>





  <section id="typography" class="topic">
<h2>Typographic support</h2>
<ul class="summary">
    <li><a href="#text_decoration"></a></li>
    <li><a href="#vertical"></a></li>
    <li><a href="#cursive"></a></li>
    <li><a href="#box_posn"></a></li>
	<li><a href="#ruby"></a></li>
	<li><a href="#typ_misc"></a></li>
</ul>


 <section id="text_decoration" class="subtopic">
    <h3>Text decoration</h3>
    <p class="advisement" id="textdec_skip"><a class="self" href="#textdec_skip">&#x200B;</a>Text decoration such as underline and overline should allow lines to skip ink.</p>
    <p class="advisement" id="textdec_distance"><a class="self" href="#textdec_distance">&#x200B;</a>It should be possible to specify the distance of overlines and underlines from the text.  <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#textdec_distance">more</a></p>
    <p>​Skipping ink for text decoration such as underlines may not be appropriate for some scripts, such as Arabic, which prefers to move the underline further away from the baseline instead.</p>

 <section class="links">
   <h4>Links</h4>
 <section class="howto">
   <h5>How to's</h5>
   <ul>
     <li class="w3">
       <p class="link"><a href="https://w3c.github.io/typography/#text_decoration">Text decoration</a></p>
       <p class="desc">In <a href="https://w3c.github.io/typography/">Language enablement index</a>.</p>
     </li>
   </ul>
 </section>
 </section>
 </section>


 <section id="vertical" class="subtopic">
    <h3>Vertical text</h3>
    <p class="advisement" id="vertical_support"><a class="self" href="#vertical_support">&#x200B;</a>It should be possible to render text vertically for languages such as Japanese, Chinese, Korean, Mongolian, etc. </p>
    <p class="advisement" id="vertical_lr_rl"><a class="self" href="#vertical_lr_rl">&#x200B;</a>Vertical text must support line progression from LTR (eg. Mongolian) and RTL (eg. Japanese) </p>
    <p class="advisement" id="vertical_lr_rl2"><a class="self" href="#vertical_lr_rl">&#x200B;</a>By default, text decoration, ruby, and the like in vertical text where lines are stacked from left to right (eg. Mongolian) should appear on the same side as for CJK vertical text. Placement should not rely on the <code class="kw" translate="no">before</code> and <code class="kw" translate="no">after</code> line locations.</p>
    <p class="advisement" id="vertical_utr50"><a class="self" href="#vertical_utr50">&#x200B;</a>Vertical writing modes that are equivalent to the <code class="kw" translate="no">vertical-</code> values in CSS (only) should use UTR50 to apply default text orientation of characters. (This does not apply to writing modes that are equivalent to <code class="kw" translate="no">sideways-</code> in CSS.)</p>
    <p class="advisement" id="vertical_upright"><a class="self" href="#vertical_upright">&#x200B;</a>By default, glyphs of scripts that are normally horizontal should run along a line in vertical text such that the top of the character is toward the right side of the vertical line, but there should also be a mechanism to allow them to progress down the line in upright orientation. Such a mechanism should use grapheme clusters as a minimum text unit, but where necessary allow syllabic clusters to be treated as a unit when they involve more than one grapheme cluster.</p>
    <p class="advisement" id="vertical_upright_arabic"><a class="self" href="#vertical_upright_arabic">&#x200B;</a>Upright Arabic text in vertical lines should use isolated letter forms and the order of text should read top to bottom.</p>
    <p class="advisement" id="vertical_tatechuyoko"><a class="self" href="#vertical_tatechuyoko">&#x200B;</a>It should be possible for some sequences of characters (particularly digits) to run horizontally within vertical lines (tate chu yoko).</p>
    <p class="advisement" id="vertical_sideways"><a class="self" href="#vertical_sideways">&#x200B;</a>Writing modes should provide values like <code class="kw" translate="no">sideways-lr</code> and <code class="kw" translate="no">sideways-rl</code> in CSS to allow for vertical rotation of  lines of horizontal script text. UTR50 is not applicable for these cases.</p>
 <section class="links">
   <h4>Links</h4>
 <section class="howto">
   <h5>How to's</h5>
   <ul>
     <li class="w3">
       <p class="link"><a href="https://w3c.github.io/typography/#vertical_text">Vertical text</a></p>
       <p class="desc">In <a href="https://w3c.github.io/typography/">Language enablement index</a>.</p>
     </li>
   </ul>
 </section>
 </section>
</section>

<section id="cursive" class="subtopic">
  <h3>Cursive text</h3>
  <p class="advisement" id="cursive_opacity"><a class="self" href="#cursive_opacity">&#x200B;</a>
    Overlaps should not be exposed when transparency is applied to the joined letters in cursive text, such as for Arabic, Mongolian, and N'Ko.
  </p>
  <p class="advisement" id="cursive_border"><a class="self" href="#cursive_border">&#x200B;</a>When adding a text stroke or shadow, joined letters should not be separated from their neighbors in cursive script text.</p>
<section class="links">
 <h4>Links</h4>
<section class="howto">
 <h5>How to's</h5>
 <ul>
   <li class="w3">
     <p class="link"><a href="https://w3c.github.io/typography/#cursive">Cursive text</a></p>
     <p class="desc">In <a href="https://w3c.github.io/typography/">Language enablement index</a>.</p>
   </li>
 </ul>
</section>
</section>
</section>

  <section id="box_posn" class="subtopic">
    <h3>Setting box positioning coordinates when text direction varies</h3>
    <p class="advisement" id="vertical_box_posn"><a class="self" href="#vertical_box_posn">&#x200B;</a>Box positioning coordinates must take into account whether the text is horizontal or vertical. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#vertical_box_posn">more</a></p>
    <p>It is typical, when localizing a user interface or web page, to create mirror-images for the RTL and LTR versions. For example, it is likely that a box that appears near the left side of a window containing English content would appear near the right side of the window if the content is Arabic or Hebrew. It should preferably automatic for this to change, based on the base direction of the current context, unless there is a strong reason for using absolute geometry. One way to achieve this is to use keywords such as <code class="kw" translate="no">start</code> and <code class="kw" translate="no">end</code>, rather than <code class="kw" translate="no">left</code> and <code class="kw" translate="no">right</code>, to indicate position.</p>
  </section>





  <section id="ruby" class="subtopic">
    <h3>Ruby text annotations</h3>
    <p class="advisement" id="type_ruby"><a class="self" href="#type_ruby">&#x200B;</a>'Ruby' style annotations alongside base text should be supported for Chinese, Japanese, Korean and Mongolian text, in both horizontal and vertical writing modes.</p>
    <p class="advisement" id="ruby_zhuyin"><a class="self" href="#ruby_zhuyin">&#x200B;</a>Ruby implementations should  support zhuyin fuhao (bopomofo) ruby for Traditional Chinese.</p>
    <p class="advisement" id="ruby_tabular"><a class="self" href="#ruby_tabular">&#x200B;</a>Ruby implementations should  support a tabular content model (such that ruby contents can be arranged in a sequence approximating to <code class="kw" translate="no">rb rb rt rt</code>).</p>
    <p class="advisement" id="ruby_rb"><a class="self" href="#ruby_rb">&#x200B;</a>Ruby implementations should make it possible to use an explicit <code class="kw" translate="no">rb</code> tag for ruby bases.</p>
    <p class="advisement" id="ruby_dblsided"><a class="self" href="#ruby_dblsided">&#x200B;</a>Ruby implementations should allow annotations to appear on either or both sides of the base text.</p>
    <section class="links">
      <h4>Links</h4>
      <section class="background">
        <h5>Background</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://www.w3.org/International/questions/qa-ruby">What is ruby?</a></p>
            <p class="desc">What are 'ruby' annotations?</p>
          </li>
        </ul>
      </section>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/typography/#ruby_annotation">Ruby</a></p>
            <p class="desc">In <a href="https://w3c.github.io/typography/">Language enablement index</a>.</p>
          </li>
        </ul>
      </section>
    </section>
  </section>



  <section id="typ_misc" class="subtopic">
    <h3>Miscellaneous</h3>
<p class="advisement" id="type_line_height"><a class="self" href="#type_line_height">&#x200B;</a>Line heights must allow for characters that are taller than English.</p>
<p class="advisement" id="type_box_size"><a class="self" href="#type_box_size">&#x200B;</a>Box sizes must allow for text expansion in translation.</p>
<p class="advisement" id="type_linebreak"><a class="self" href="#type_linebreak">&#x200B;</a>Line wrapping should take into account the special rules needed for non-Latin scripts. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#type_linebreak">more</a></p>
<p>Various non-Latin writing systems don't simply wrap text on inter-word spaces. They have additional rules that must be respected. For example</p>
<ul>
<li>Chinese, Japanese and Korean wrap after characters, but don't put certain characters at the start/end of a line.</li>
<li>Thai and other SE Asian scripts wrap at word boundaries, but words are not delimited by spaces – spaces are instead used to separate phrases.</li>
<li>Tibetan wraps after the tsek character that follows a syllable – words are not separated by spaces, and lines can break within a word.</li>
<li>Indic and other complex scripts break at orthographic syllable boundaries, which are often two or more grapheme clusters.</li>
</ul>
<p>See the <a href="https://www.w3.org/TR/css-text-3/#line-breaking">CSS Text Level 3 specification</a> for additional background. (<a href="https://r12a.github.io/scripts/tutorial/part5">This tutorial</a> provides additional examples, if needed.)</p>
<p class="advisement" id="type_presentational_tags"><a class="self" href="#type_presentational_tags">&#x200B;</a>Avoid specifying presentational tags, such as <code class="kw" translate="no">b</code> for bold, and <code class="kw" translate="no">i</code> for italic. <a class="local" href="https://w3c.github.io/bp-i18n-specdev/#type_presentational_tags">more</a></p>
<p> It is best to avoid presentational markup <code class="kw" translate="no">b</code>, <code class="kw" translate="no">i</code> or <code class="kw" translate="no">u</code>, since it isn't interoperable across writing systems and furthermore may cause unnecessary problems for localisation. In addition, some scripts have native approaches to things such as emphasis, that do not involve, and can be very different from, bolding, italicisation, etc.</p>
<p>In the HTML case, there was a legacy issue, but unless there is one for your specification, the recommendation is that styling be used instead to determine the presentation of the text, and that any markup or tagging should allow for general semantic approaches.</p>
<p>For an explanation of the issues surrounding <code class="kw" translate="no">b</code> and <code class="kw" translate="no">i</code> tags, see <a href="https://www.w3.org/International/questions/qa-b-and-i-tags">Using &lt;b&gt; and &lt;i&gt; elements</a>.</p>
</section>
</section>


<section id="locale" class="topic">
<h2>Locales, date and time values, and locally affected formats</h2>
<ul class="summary">
  <li><a href="#loc_neutral">Working with locale-affected values</a></li>
  <li><a href="#loc_time">Working with time</a></li>
  <li><a href="#loc_names">Working with personal names</a></li>
  <li><a href="#loc_forms">Designing forms</a></li>
  <li><a href="#loc_numbers">Working with numbers</a></li>
</ul>

<section id="loc_neutral" class="subtopic">
	<h2>Working with locale-affected values</h2>

<p>Software systems that support languages and cultural preferences are said to be <q>internationalized</q>. An internationalized system uses APIs to provide language or culturally specific processing, based on user preferences. These user preferences are usually referred to as a <q>locale</q>. For more information on general internationalization terminology, see <cite>Language Tags and Locale Identifiers</cite> [[LTLI]]</p>

<p class="advisement" id="loc_neutral_neutral"><a class="self" href="#loc_neutral_neutral">&#x200B;</a>When definining data formats, use locale-neutral serialization forms.</p>

</section>

  <section id="loc_time" class="subtopic"><h3>Working with time</h3>
<p class="advisement" id="loc_time_preCE"><a class="self" href="#loc_time_preCE">&#x200B;</a>When defining calendar and date systems, be sure to allow for dates prior to the common era, or at least define handling of dates outside the most common range.</p>
<p class="advisement" id="loc_time_utc"><a class="self" href="#loc_time_utc">&#x200B;</a>When defining time or date data types, ensure that the time zone or relationship to UTC is always defined.</p>

<p class="advisement" id="loc_time_floating"><a class="self" href="#loc_time_floating">&#x200B;</a>Provide a health warning for conversion of time or date data types that are "floating" to/from incremental types, referring as necessary to the <a href="https://www.w3.org/TR/timezone/"><cite>Time Zones</cite> WG Note</a>.  <a href="https://www.w3.org/TR/timezone/">more</a></p>
<p class="advisement" id="loc_time_leapsec"><a class="self" href="#loc_time_leapsec">&#x200B;</a>Allow for leap seconds in date and time data types.  <a href="https://w3c.github.io/bp-i18n-specdev/#loc_time_leapsec">more</a></p>
<p>These occur occasionally when the number of seconds in a minute is allowed to range from 0 to 60 (ie. there are sixty-ONE seconds in that minute).</p>
<p class="advisement" id="loc_time_consistency"><a class="self" href="#loc_time_consistency">&#x200B;</a>Use consistent terminology when discussing date and time values. Use 'floating' time for time zone independent values.</p>
<p class="advisement" id="loc_time_zone_offset"><a class="self" href="#loc_time_zone_offset">&#x200B;</a>Keep separate the definition of time zone from time zone offset.</p>
<p class="advisement" id="loc_time_zone_ids"><a class="self" href="#loc_time_zone_ids">&#x200B;</a>Use IANA time zone IDs to identify time zones. Do not use offsets or LTO as a proxy for time zone.</p>
<p class="advisement" id="loc_time_zone_field"><a class="self" href="#loc_time_zone_field">&#x200B;</a>Use a separate field to identify time zone.</p>
<p class="advisement" id="loc_time_week"><a class="self" href="#loc_time_week">&#x200B;</a>When defining rules for a "week", allow for culturally specific rules to be applied.  <a href="https://w3c.github.io/bp-i18n-specdev/#loc_time_week">more</a></p>
<p>For example, the weekend is not always Saturday/Sunday; the first day of week is not always Sunday [or Monday or...], etc.</p>
<p class="advisement" id="loc_time_week_number"><a class="self" href="#loc_time_week_number">&#x200B;</a>When defining rules for week number of year, allow for culturally specific rules to be applied.</p>
<p class="advisement" id="loc_time_13"><a class="self" href="#loc_time_13">&#x200B;</a>When non-Gregorian calendars are permitted, note that the "month" field can go to 13 (undecimber).</p>
</section>


  <section id="loc_names" class="subtopic"><h3>Working with personal names</h3>
<p class="advisement" id="loc_names_given_family"><a class="self" href="#loc_names_given_family">&#x200B;</a>Check whether you really need to store or access given name and family name separately.  <a href="https://www.w3.org/International/questions/qa-personal-names#singlefield">more</a></p>
<p class="advisement" id="loc_names_limits"><a class="self" href="#loc_names_limits">&#x200B;</a>Avoid placing limits on the length of names, or if you do, make allowance for long strings.  <a href="https://www.w3.org/International/questions/qa-personal-names#singlefield">more</a></p>
<p class="advisement" id="loc_names_first_last"><a class="self" href="#loc_names_first_last">&#x200B;</a>Try to avoid using the labels 'first name' and 'last name' in non-localized contexts.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_extra_fields"><a class="self" href="#loc_names_extra_fields">&#x200B;</a>Consider whether it would make sense to have one or more extra fields, in addition to the full name field, where users can provide part(s) of their name that you need to use for a specific purpose.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_how_contact"><a class="self" href="#loc_names_how_contact">&#x200B;</a>Allow for users to be asked separately how they would like you be addressed when someone contacts them.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_relevant_info"><a class="self" href="#loc_names_relevant_info">&#x200B;</a>If parts of a person's name are captured separately, ensure that the separate items can capture all relevant information.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_algorithms"><a class="self" href="#loc_names_algorithms">&#x200B;</a>Be careful about assumptions built into algorithms that pull out the parts of a name automatically.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_initials"><a class="self" href="#loc_names_initials">&#x200B;</a>Don't assume that a single letter name is an initial.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_famname_reqd"><a class="self" href="#loc_names_famname_reqd">&#x200B;</a>Don't require that people supply a family name.  <a href="https://www.w3.org/International/questions/qa-personal-names#splitting">more</a></p>
<p class="advisement" id="loc_names_punctuation"><a class="self" href="#loc_names_punctuation">&#x200B;</a>Don't forget to allow people to use punctuation such as hyphens, apostrophes, etc. in names.  <a href="https://www.w3.org/International/questions/qa-personal-names#otherthings">more</a></p>
<p class="advisement" id="loc_names_uppercase"><a class="self" href="#loc_names_uppercase">&#x200B;</a>Don't require names to be entered all in upper case.  <a href="https://www.w3.org/International/questions/qa-personal-names#otherthings">more</a></p>
<p class="advisement" id="loc_names_case_normalization"><a class="self" href="#loc_names_case_normalization">&#x200B;</a>Don't normalize the casing in names.  <a href="https://www.w3.org/International/questions/qa-personal-names.en#req_case_normalization">more</a></p>
<p class="advisement" id="loc_names_spaces"><a class="self" href="#loc_names_spaces">&#x200B;</a>Allow the user to enter a name with spaces.  <a href="https://www.w3.org/International/questions/qa-personal-names#otherthings">more</a></p>
<p class="advisement" id="loc_names_same_names"><a class="self" href="#loc_names_same_names">&#x200B;</a>Don't assume that members of the same family will share the same family name.  <a href="https://www.w3.org/International/questions/qa-personal-names#otherthings">more</a></p>
<p class="advisement" id="loc_names_nee"><a class="self" href="#loc_names_nee">&#x200B;</a>It may be better for a form to ask for 'Previous name' rather than 'Maiden name' or 'née'.  <a href="https://www.w3.org/International/questions/qa-personal-names#otherthings">more</a></p>
<p class="advisement" id="loc_names_latin_native"><a class="self" href="#loc_names_latin_native">&#x200B;</a>You may want to store the name in both Latin and native scripts, in which case you probably need to ask the user to submit their name in both native script and Latin-only form, as separate items.  <a href="https://www.w3.org/International/questions/qa-personal-names#encoding">more</a></p>
<p class="advisement" id="loc_names_global_audience"><a class="self" href="#loc_names_global_audience">&#x200B;</a>In standards and standard related documents, then working with examples including person names, use a variety of names that reflects a global audience. Avoid a bias of names to certain regions.  <!--No QA text available yet. <a href="https://www.w3.org/International/questions/qa-personal-names#@@@@">more</a>--></p>
</section>
  <section class="links">
    <h4>Links</h4>
    <section class="background">
      <h5>Background</h5>
      <ul>
        <li class="w3">
          <p class="link"><a href="https://www.w3.org/International/questions/qa-personal-names">Personal names around the world</a></p>
          <p class="desc">How do people's names differ around the world, and what are the implications of those differences on the design of forms, databases, ontologies, etc. for the Web?</p>
        </li>
      </ul>
    </section>
  </section>


  <section id="loc_forms" class="subtopic"><h3>Designing forms</h3>
  <p class="advisement" id="loc_forms_eai"><a class="self" href="#loc_forms_eai">&#x200B;</a>When defining email field validation, allow for EAI (smtputf8) names.</p>
</section>


  <section id="loc_numbers" class="subtopic"><h3>Working with numbers</h3>
<p class="advisement" id="loc_numbers_shape_parse"><a class="self" href="#loc_numbers_shape_parse">&#x200B;</a>When parsing user input of numeric values, allow for digit shaping (non-ASCII digits).</p>
<p class="advisement" id="loc_numbers_shape_display"><a class="self" href="#loc_numbers_shape_display">&#x200B;</a>When formatting numeric values for display, allow for culturally sensitive display, including the use of non-ASCII digits (digit shaping).</p>
</section>

<section id="localization" class="subtopic"><h3>Localization</h3>

<p><a href="https://www.w3.org/TR/ltli/#localization">Localization</a> [[LTLI]] enables users to employ software in the language and locale of their choice. Specifications for protocols and document formats need to consider how to provide the language and formatting that the end-user expects.</p>

<p class="advisement" id="l10n_api_message_id">APIs and protocols SHOULD provide language independent identifiers for errors.</p>

<p>For example, HTTP result codes, such as the familiar <code>404</code>, help users communicate which error they received or look up a translation.</p>

<p class="advisement" id="l10n_api_error_message_metadata">APIs and protocols SHOULD include language and base direction metadata for all natural language messages and data fields.</p>

<p>Natural language data values need language and base direction in order to ensure proper presentation, even if localized messages are not provided. This includes any error messages or other internal messages that are human readable in an API or protocol. See also [[STRING-META]].</p>

<p class="advisement" id="l10n_api_error_message_language">All natural language fields or messages, including error messages, defined by a given API or protocol SHOULD be localized into the preferred locale of the user or, if that language is not available, supplied with a suitable fallback or default.</p>

<p class="advisement" id="l10n_api_lang_nego">Specifications for APIs or protocols SHOULD define how the user's locale is determined (this is sometimes called <a href="#lang_negotiation">language negotiation</a>).</p>

<p class="advisement" id="l10n_api_lang_defaulting">Specifications MAY define a specific default language for messages or errors in an API or protocol.</p>

<p class="note">Specifications do not need to require that messages be returned in all possible or all available locales. It is sufficient to make it possible to localize the end-user's customer experience. Implementations can choose which languages or locales to support.</p>

</section>

</section>




<section id="navigation" class="topic">
  <h2>Navigation</h2>
  <ul class="summary">
    <li><a href="#lang_negotiation">Providing for content negotiation based on language</a></li>
  </ul>

  <section id="lang_negotiation" class="subtopic">
    <h3>Providing for  content negotiation based on language</h3>
    <p class="advisement" id="lang_neg"><a class="self" href="#lang_neg">&#x200B;</a>In a multilingual environment it must be possible for the user to receive text in the language they prefer. This may depend on implicit user preferences based on the user's system or browser setup, or on user settings explicitly negotiated with the user.</p>

     <section class="links">
      <h4>Links</h4>
      <section class="howto">
        <h5>How to's</h5>
        <ul>
          <li class="w3">
            <p class="link"><a href="https://w3c.github.io/bp-i18n-specdev/#lang_negotiation">Providing for  content negotiation based on language</a></p>
            <p class="desc">In <a href="https://w3c.github.io/bp-i18n-specdev/">Internationalization Best Practices for Spec Developers</a>.</p>
          </li>
        </ul>
      </section>
    </section>
 </section>
</section>

<section class="appendix" id="ghChecklist">
<h2>Create a github checklist</h2>
<p>You can take a snapshot of the checklist, and paste it into an issue in your Github repository. Then you can click on a checkbox alongside a checklist item to indicate whether or not your spec supports it, or you can add your own notes/questions by editing the issue.</p>
<p>To do this, simply click on the button just below, then paste the output it generates into a new issue in your repository.</p>

<p><button onClick="document.getElementById('ghIssue').value = createIssueText(); document.getElementById('ghIssue').select();">Create github issue checklist</button></p>

<textarea id="ghIssue" style="width: 100%; height: 400px;"></textarea>
</section>


<section class="appendix" id="app-c">
  <h2> Revision Log</h2>
  <p>The following summarises substantive changes since the previous publication, but the material is still subject to significant flux as it develops. This should not be a reason not to use the document. What it so far contains is useful, and any shortfalls can be reported or discussed.</p>
  <ol>
    <li>A variety of additional guidelines were added after working through previous review comments.</li>
    <li>Structure of the document changed to better reflect the world as seen by spec developers.</li>
  </ol>
    <p>See the <a href="https://github.com/w3c/bp-i18n-specdev/commits/gh-pages">github commit log</a> for more details.</p>
</section>


<section class="appendix" id="ack">
<h2>Acknowledgements</h2>
<p>Thanks to Addison Phillips for help reviewing old reviews for recommendations.</p>
<p>Other people who contributed through reviews or issues include Steve Atkin, Andrew Cunnigham, Martin Dürst, Asmus Freytag, John Klensin, Tomer Mahlin, Chaals McCathieNevile, Florian Rivoal.</p>
</section>


<button onClick="document.getElementById('dump').value = dumpData(); document.getElementById('dump').select();">Dump data</button>
<textarea id="dump" style="width: 100%; height: 400px;"></textarea>


</body>
</html>
